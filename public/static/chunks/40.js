(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[40],{

/***/ "./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/wangeditor/release/wangEditor.min.css":
/*!********************************************************************************************************************************************!*\
  !*** ./node_modules/css-loader??ref--6-1!./node_modules/postcss-loader/src??ref--6-2!./node_modules/wangeditor/release/wangEditor.min.css ***!
  \********************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(/*! ../../css-loader/lib/css-base.js */ "./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".w-e-text-container .w-e-panel-container .w-e-panel-tab-content button:focus,.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input:focus,.w-e-text-container .w-e-panel-container .w-e-panel-tab-content textarea:focus,.w-e-text:focus{outline:0}.w-e-menu-panel,.w-e-menu-panel *,.w-e-text-container,.w-e-text-container *,.w-e-toolbar,.w-e-toolbar *{padding:0;margin:0;box-sizing:border-box}.w-e-clear-fix:after{content:\"\";display:table;clear:both}.w-e-toolbar .w-e-droplist{position:absolute;left:0;top:0;background-color:#fff;border:1px solid #f1f1f1;border-right-color:#ccc;border-bottom-color:#ccc}.w-e-toolbar .w-e-droplist ul.w-e-block li.w-e-item:hover,.w-e-toolbar .w-e-droplist ul.w-e-list li.w-e-item:hover{background-color:#f1f1f1}.w-e-toolbar .w-e-droplist .w-e-dp-title{text-align:center;color:#999;line-height:2;border-bottom:1px solid #f1f1f1;font-size:13px}.w-e-toolbar .w-e-droplist ul.w-e-list{list-style:none;line-height:1}.w-e-toolbar .w-e-droplist ul.w-e-list li.w-e-item{color:#333;padding:5px 0}.w-e-toolbar .w-e-droplist ul.w-e-block{list-style:none;text-align:left;padding:5px}.w-e-toolbar .w-e-droplist ul.w-e-block li.w-e-item{display:inline-block;padding:3px 5px}@font-face{font-family:w-e-icon;src:url(data:application/x-font-woff;charset=utf-8;base64,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) format('truetype');font-weight:400;font-style:normal}[class*=\" w-e-icon-\"],[class^=w-e-icon-]{font-family:w-e-icon!important;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.w-e-icon-close:before{content:\"\\F00D\"}.w-e-icon-upload2:before{content:\"\\E9C6\"}.w-e-icon-trash-o:before{content:\"\\F014\"}.w-e-icon-header:before{content:\"\\F1DC\"}.w-e-icon-pencil2:before{content:\"\\E906\"}.w-e-icon-paint-brush:before{content:\"\\F1FC\"}.w-e-icon-image:before{content:\"\\E90D\"}.w-e-icon-play:before{content:\"\\E912\"}.w-e-icon-location:before{content:\"\\E947\"}.w-e-icon-undo:before{content:\"\\E965\"}.w-e-icon-redo:before{content:\"\\E966\"}.w-e-icon-quotes-left:before{content:\"\\E977\"}.w-e-icon-list-numbered:before{content:\"\\E9B9\"}.w-e-icon-list2:before{content:\"\\E9BB\"}.w-e-icon-link:before{content:\"\\E9CB\"}.w-e-icon-happy:before{content:\"\\E9DF\"}.w-e-icon-bold:before{content:\"\\EA62\"}.w-e-icon-underline:before{content:\"\\EA63\"}.w-e-icon-italic:before{content:\"\\EA64\"}.w-e-icon-strikethrough:before{content:\"\\EA65\"}.w-e-icon-table2:before{content:\"\\EA71\"}.w-e-icon-paragraph-left:before{content:\"\\EA77\"}.w-e-icon-paragraph-center:before{content:\"\\EA78\"}.w-e-icon-paragraph-right:before{content:\"\\EA79\"}.w-e-icon-terminal:before{content:\"\\F120\"}.w-e-icon-page-break:before{content:\"\\EA68\"}.w-e-icon-cancel-circle:before{content:\"\\EA0D\"}.w-e-icon-font:before{content:\"\\EA5C\"}.w-e-icon-text-heigh:before{content:\"\\EA5F\"}.w-e-toolbar{display:flex;padding:0 5px}.w-e-toolbar .w-e-menu{position:relative;text-align:center;padding:5px 10px;cursor:pointer}.w-e-toolbar .w-e-menu i{color:#999}.w-e-toolbar .w-e-menu:hover i{color:#333}.w-e-toolbar .w-e-active i,.w-e-toolbar .w-e-active:hover i{color:#1e88e5}.w-e-text-container .w-e-panel-container{position:absolute;top:0;left:50%;border:1px solid #ccc;border-top:0;box-shadow:1px 1px 2px #ccc;color:#333;background-color:#fff}.w-e-text-container .w-e-panel-container .w-e-panel-close{position:absolute;right:0;top:0;padding:5px;margin:2px 5px 0 0;cursor:pointer;color:#999}.w-e-text-container .w-e-panel-container .w-e-panel-close:hover{color:#333}.w-e-text-container .w-e-panel-container .w-e-panel-tab-title{list-style:none;display:flex;font-size:14px;margin:2px 10px 0;border-bottom:1px solid #f1f1f1}.w-e-text-container .w-e-panel-container .w-e-panel-tab-title .w-e-item{padding:3px 5px;color:#999;cursor:pointer;margin:0 3px;position:relative;top:1px}.w-e-text-container .w-e-panel-container .w-e-panel-tab-title .w-e-active{color:#333;border-bottom:1px solid #333;cursor:default;font-weight:700}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content{padding:10px 15px;font-size:16px}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content textarea{width:100%;border:1px solid #ccc;padding:5px}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content textarea:focus{border-color:#1e88e5}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text]{border:none;border-bottom:1px solid #ccc;font-size:14px;height:20px;color:#333;text-align:left}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text].small{width:30px;text-align:center}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text].block{display:block;width:100%;margin:10px 0}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text]:focus{border-bottom:2px solid #1e88e5}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button{font-size:14px;color:#1e88e5;border:none;padding:5px 10px;background-color:#fff;cursor:pointer;border-radius:3px}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.left{float:left;margin-right:10px}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.right{float:right;margin-left:10px}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.gray{color:#999}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.red{color:#c24f4a}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button:hover{background-color:#f1f1f1}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container:after{content:\"\";display:table;clear:both}.w-e-text-container .w-e-panel-container .w-e-emoticon-container .w-e-item{cursor:pointer;font-size:18px;padding:0 3px;display:inline-block}.w-e-text-container .w-e-panel-container .w-e-up-img-container{text-align:center}.w-e-text-container .w-e-panel-container .w-e-up-img-container .w-e-up-btn{display:inline-block;color:#999;cursor:pointer;font-size:60px;line-height:1}.w-e-text-container .w-e-panel-container .w-e-up-img-container .w-e-up-btn:hover{color:#333}.w-e-text-container{position:relative}.w-e-text-container .w-e-progress{position:absolute;background-color:#1e88e5;bottom:0;left:0;height:1px}.w-e-text{padding:0 10px;overflow-y:scroll}.w-e-text h1,.w-e-text h2,.w-e-text h3,.w-e-text h4,.w-e-text h5,.w-e-text p,.w-e-text pre,.w-e-text table{margin:10px 0;line-height:1.5}.w-e-text ol,.w-e-text ul{margin:10px 0 10px 20px}.w-e-text blockquote{display:block;border-left:8px solid #d0e5f2;padding:5px 10px;margin:10px 0;line-height:1.4;font-size:100%;background-color:#f1f1f1}.w-e-text code{display:inline-block;background-color:#f1f1f1;border-radius:3px;padding:3px 5px;margin:0 3px}.w-e-text pre code{display:block}.w-e-text table{border-top:1px solid #ccc;border-left:1px solid #ccc}.w-e-text table td,.w-e-text table th{border-bottom:1px solid #ccc;border-right:1px solid #ccc;padding:3px 5px}.w-e-text table th{border-bottom:2px solid #ccc;text-align:center}.w-e-text img{cursor:pointer}.w-e-text img:hover{box-shadow:0 0 5px #333}", ""]);

// exports


/***/ }),

/***/ "./node_modules/wangeditor/release/wangEditor.js":
/*!*******************************************************!*\
  !*** ./node_modules/wangeditor/release/wangEditor.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

(function (global, factory) {
	 true ? module.exports = factory() :
	undefined;
}(this, (function () { 'use strict';

/*
    poly-fill
*/

var polyfill = function () {

    // Object.assign
    if (typeof Object.assign != 'function') {
        Object.assign = function (target, varArgs) {
            // .length of function is 2
            if (target == null) {
                // TypeError if undefined or null
                throw new TypeError('Cannot convert undefined or null to object');
            }

            var to = Object(target);

            for (var index = 1; index < arguments.length; index++) {
                var nextSource = arguments[index];

                if (nextSource != null) {
                    // Skip over if undefined or null
                    for (var nextKey in nextSource) {
                        // Avoid bugs when hasOwnProperty is shadowed
                        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                            to[nextKey] = nextSource[nextKey];
                        }
                    }
                }
            }
            return to;
        };
    }

    // IE ‰∏≠ÂÖºÂÆπ Element.prototype.matches
    if (!Element.prototype.matches) {
        Element.prototype.matches = Element.prototype.matchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector || Element.prototype.webkitMatchesSelector || function (s) {
            var matches = (this.document || this.ownerDocument).querySelectorAll(s),
                i = matches.length;
            while (--i >= 0 && matches.item(i) !== this) {}
            return i > -1;
        };
    }
};

/*
    DOM Êìç‰Ωú API
*/

// Ê†πÊçÆ html ‰ª£Á†ÅÁâáÊÆµÂàõÂª∫ dom ÂØπË±°
function createElemByHTML(html) {
    var div = void 0;
    div = document.createElement('div');
    div.innerHTML = html;
    return div.children;
}

// ÊòØÂê¶ÊòØ DOM List
function isDOMList(selector) {
    if (!selector) {
        return false;
    }
    if (selector instanceof HTMLCollection || selector instanceof NodeList) {
        return true;
    }
    return false;
}

// Â∞ÅË£Ö document.querySelectorAll
function querySelectorAll(selector) {
    var result = document.querySelectorAll(selector);
    if (isDOMList(result)) {
        return result;
    } else {
        return [result];
    }
}

// ËÆ∞ÂΩïÊâÄÊúâÁöÑ‰∫ã‰ª∂ÁªëÂÆö
var eventList = [];

// ÂàõÂª∫ÊûÑÈÄ†ÂáΩÊï∞
function DomElement(selector) {
    if (!selector) {
        return;
    }

    // selector Êú¨Êù•Â∞±ÊòØ DomElement ÂØπË±°ÔºåÁõ¥Êé•ËøîÂõû
    if (selector instanceof DomElement) {
        return selector;
    }

    this.selector = selector;
    var nodeType = selector.nodeType;

    // Ê†πÊçÆ selector ÂæóÂá∫ÁöÑÁªìÊûúÔºàÂ¶Ç DOMÔºåDOM ListÔºâ
    var selectorResult = [];
    if (nodeType === 9) {
        // document ËäÇÁÇπ
        selectorResult = [selector];
    } else if (nodeType === 1) {
        // Âçï‰∏™ DOM ËäÇÁÇπ
        selectorResult = [selector];
    } else if (isDOMList(selector) || selector instanceof Array) {
        // DOM List ÊàñËÄÖÊï∞ÁªÑ
        selectorResult = selector;
    } else if (typeof selector === 'string') {
        // Â≠óÁ¨¶‰∏≤
        selector = selector.replace('/\n/mg', '').trim();
        if (selector.indexOf('<') === 0) {
            // Â¶Ç <div>
            selectorResult = createElemByHTML(selector);
        } else {
            // Â¶Ç #id .class
            selectorResult = querySelectorAll(selector);
        }
    }

    var length = selectorResult.length;
    if (!length) {
        // Á©∫Êï∞ÁªÑ
        return this;
    }

    // Âä†ÂÖ• DOM ËäÇÁÇπ
    var i = void 0;
    for (i = 0; i < length; i++) {
        this[i] = selectorResult[i];
    }
    this.length = length;
}

// ‰øÆÊîπÂéüÂûã
DomElement.prototype = {
    constructor: DomElement,

    // Á±ªÊï∞ÁªÑÔºåforEach
    forEach: function forEach(fn) {
        var i = void 0;
        for (i = 0; i < this.length; i++) {
            var elem = this[i];
            var result = fn.call(elem, elem, i);
            if (result === false) {
                break;
            }
        }
        return this;
    },

    // clone
    clone: function clone(deep) {
        var cloneList = [];
        this.forEach(function (elem) {
            cloneList.push(elem.cloneNode(!!deep));
        });
        return $(cloneList);
    },

    // Ëé∑ÂèñÁ¨¨Âá†‰∏™ÂÖÉÁ¥†
    get: function get(index) {
        var length = this.length;
        if (index >= length) {
            index = index % length;
        }
        return $(this[index]);
    },

    // Á¨¨‰∏Ä‰∏™
    first: function first() {
        return this.get(0);
    },

    // ÊúÄÂêé‰∏Ä‰∏™
    last: function last() {
        var length = this.length;
        return this.get(length - 1);
    },

    // ÁªëÂÆö‰∫ã‰ª∂
    on: function on(type, selector, fn) {
        // selector ‰∏ç‰∏∫Á©∫ÔºåËØÅÊòéÁªëÂÆö‰∫ã‰ª∂Ë¶ÅÂä†‰ª£ÁêÜ
        if (!fn) {
            fn = selector;
            selector = null;
        }

        // type ÊòØÂê¶ÊúâÂ§ö‰∏™
        var types = [];
        types = type.split(/\s+/);

        return this.forEach(function (elem) {
            types.forEach(function (type) {
                if (!type) {
                    return;
                }

                // ËÆ∞ÂΩï‰∏ãÔºåÊñπ‰æøÂêéÈù¢Ëß£Áªë
                eventList.push({
                    elem: elem,
                    type: type,
                    fn: fn
                });

                if (!selector) {
                    // Êó†‰ª£ÁêÜ
                    elem.addEventListener(type, fn);
                    return;
                }

                // Êúâ‰ª£ÁêÜ
                elem.addEventListener(type, function (e) {
                    var target = e.target;
                    if (target.matches(selector)) {
                        fn.call(target, e);
                    }
                });
            });
        });
    },

    // ÂèñÊ∂à‰∫ã‰ª∂ÁªëÂÆö
    off: function off(type, fn) {
        return this.forEach(function (elem) {
            elem.removeEventListener(type, fn);
        });
    },

    // Ëé∑Âèñ/ËÆæÁΩÆ Â±ûÊÄß
    attr: function attr(key, val) {
        if (val == null) {
            // Ëé∑ÂèñÂÄº
            return this[0].getAttribute(key);
        } else {
            // ËÆæÁΩÆÂÄº
            return this.forEach(function (elem) {
                elem.setAttribute(key, val);
            });
        }
    },

    // Ê∑ªÂä† class
    addClass: function addClass(className) {
        if (!className) {
            return this;
        }
        return this.forEach(function (elem) {
            var arr = void 0;
            if (elem.className) {
                // Ëß£ÊûêÂΩìÂâç className ËΩ¨Êç¢‰∏∫Êï∞ÁªÑ
                arr = elem.className.split(/\s/);
                arr = arr.filter(function (item) {
                    return !!item.trim();
                });
                // Ê∑ªÂä† class
                if (arr.indexOf(className) < 0) {
                    arr.push(className);
                }
                // ‰øÆÊîπ elem.class
                elem.className = arr.join(' ');
            } else {
                elem.className = className;
            }
        });
    },

    // Âà†Èô§ class
    removeClass: function removeClass(className) {
        if (!className) {
            return this;
        }
        return this.forEach(function (elem) {
            var arr = void 0;
            if (elem.className) {
                // Ëß£ÊûêÂΩìÂâç className ËΩ¨Êç¢‰∏∫Êï∞ÁªÑ
                arr = elem.className.split(/\s/);
                arr = arr.filter(function (item) {
                    item = item.trim();
                    // Âà†Èô§ class
                    if (!item || item === className) {
                        return false;
                    }
                    return true;
                });
                // ‰øÆÊîπ elem.class
                elem.className = arr.join(' ');
            }
        });
    },

    // ‰øÆÊîπ css
    css: function css(key, val) {
        var currentStyle = key + ':' + val + ';';
        return this.forEach(function (elem) {
            var style = (elem.getAttribute('style') || '').trim();
            var styleArr = void 0,
                resultArr = [];
            if (style) {
                // Â∞Ü style ÊåâÁÖß ; ÊãÜÂàÜ‰∏∫Êï∞ÁªÑ
                styleArr = style.split(';');
                styleArr.forEach(function (item) {
                    // ÂØπÊØèÈ°πÊ†∑ÂºèÔºåÊåâÁÖß : ÊãÜÂàÜ‰∏∫ key Âíå value
                    var arr = item.split(':').map(function (i) {
                        return i.trim();
                    });
                    if (arr.length === 2) {
                        resultArr.push(arr[0] + ':' + arr[1]);
                    }
                });
                // ÊõøÊç¢ÊàñËÄÖÊñ∞Â¢û
                resultArr = resultArr.map(function (item) {
                    if (item.indexOf(key) === 0) {
                        return currentStyle;
                    } else {
                        return item;
                    }
                });
                if (resultArr.indexOf(currentStyle) < 0) {
                    resultArr.push(currentStyle);
                }
                // ÁªìÊûú
                elem.setAttribute('style', resultArr.join('; '));
            } else {
                // style Êó†ÂÄº
                elem.setAttribute('style', currentStyle);
            }
        });
    },

    // ÊòæÁ§∫
    show: function show() {
        return this.css('display', 'block');
    },

    // ÈöêËóè
    hide: function hide() {
        return this.css('display', 'none');
    },

    // Ëé∑ÂèñÂ≠êËäÇÁÇπ
    children: function children() {
        var elem = this[0];
        if (!elem) {
            return null;
        }

        return $(elem.children);
    },

    // Ëé∑ÂèñÂ≠êËäÇÁÇπÔºàÂåÖÊã¨ÊñáÊú¨ËäÇÁÇπÔºâ
    childNodes: function childNodes() {
        var elem = this[0];
        if (!elem) {
            return null;
        }

        return $(elem.childNodes);
    },

    // Â¢ûÂä†Â≠êËäÇÁÇπ
    append: function append($children) {
        return this.forEach(function (elem) {
            $children.forEach(function (child) {
                elem.appendChild(child);
            });
        });
    },

    // ÁßªÈô§ÂΩìÂâçËäÇÁÇπ
    remove: function remove() {
        return this.forEach(function (elem) {
            if (elem.remove) {
                elem.remove();
            } else {
                var parent = elem.parentElement;
                parent && parent.removeChild(elem);
            }
        });
    },

    // ÊòØÂê¶ÂåÖÂê´Êüê‰∏™Â≠êËäÇÁÇπ
    isContain: function isContain($child) {
        var elem = this[0];
        var child = $child[0];
        return elem.contains(child);
    },

    // Â∞∫ÂØ∏Êï∞ÊçÆ
    getSizeData: function getSizeData() {
        var elem = this[0];
        return elem.getBoundingClientRect(); // ÂèØÂæóÂà∞ bottom height left right top width ÁöÑÊï∞ÊçÆ
    },

    // Â∞ÅË£Ö nodeName
    getNodeName: function getNodeName() {
        var elem = this[0];
        return elem.nodeName;
    },

    // ‰ªéÂΩìÂâçÂÖÉÁ¥†Êü•Êâæ
    find: function find(selector) {
        var elem = this[0];
        return $(elem.querySelectorAll(selector));
    },

    // Ëé∑ÂèñÂΩìÂâçÂÖÉÁ¥†ÁöÑ text
    text: function text(val) {
        if (!val) {
            // Ëé∑Âèñ text
            var elem = this[0];
            return elem.innerHTML.replace(/<.*?>/g, function () {
                return '';
            });
        } else {
            // ËÆæÁΩÆ text
            return this.forEach(function (elem) {
                elem.innerHTML = val;
            });
        }
    },

    // Ëé∑Âèñ html
    html: function html(value) {
        var elem = this[0];
        if (value == null) {
            return elem.innerHTML;
        } else {
            elem.innerHTML = value;
            return this;
        }
    },

    // Ëé∑Âèñ value
    val: function val() {
        var elem = this[0];
        return elem.value.trim();
    },

    // focus
    focus: function focus() {
        return this.forEach(function (elem) {
            elem.focus();
        });
    },

    // parent
    parent: function parent() {
        var elem = this[0];
        return $(elem.parentElement);
    },

    // parentUntil ÊâæÂà∞Á¨¶Âêà selector ÁöÑÁà∂ËäÇÁÇπ
    parentUntil: function parentUntil(selector, _currentElem) {
        var results = document.querySelectorAll(selector);
        var length = results.length;
        if (!length) {
            // ‰º†ÂÖ•ÁöÑ selector Êó†Êïà
            return null;
        }

        var elem = _currentElem || this[0];
        if (elem.nodeName === 'BODY') {
            return null;
        }

        var parent = elem.parentElement;
        var i = void 0;
        for (i = 0; i < length; i++) {
            if (parent === results[i]) {
                // ÊâæÂà∞ÔºåÂπ∂ËøîÂõû
                return $(parent);
            }
        }

        // ÁªßÁª≠Êü•Êâæ
        return this.parentUntil(selector, parent);
    },

    // Âà§Êñ≠‰∏§‰∏™ elem ÊòØÂê¶Áõ∏Á≠â
    equal: function equal($elem) {
        if ($elem.nodeType === 1) {
            return this[0] === $elem;
        } else {
            return this[0] === $elem[0];
        }
    },

    // Â∞ÜËØ•ÂÖÉÁ¥†ÊèíÂÖ•Âà∞Êüê‰∏™ÂÖÉÁ¥†ÂâçÈù¢
    insertBefore: function insertBefore(selector) {
        var $referenceNode = $(selector);
        var referenceNode = $referenceNode[0];
        if (!referenceNode) {
            return this;
        }
        return this.forEach(function (elem) {
            var parent = referenceNode.parentNode;
            parent.insertBefore(elem, referenceNode);
        });
    },

    // Â∞ÜËØ•ÂÖÉÁ¥†ÊèíÂÖ•Âà∞Êüê‰∏™ÂÖÉÁ¥†ÂêéÈù¢
    insertAfter: function insertAfter(selector) {
        var $referenceNode = $(selector);
        var referenceNode = $referenceNode[0];
        if (!referenceNode) {
            return this;
        }
        return this.forEach(function (elem) {
            var parent = referenceNode.parentNode;
            if (parent.lastChild === referenceNode) {
                // ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†
                parent.appendChild(elem);
            } else {
                // ‰∏çÊòØÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†
                parent.insertBefore(elem, referenceNode.nextSibling);
            }
        });
    }
};

// new ‰∏Ä‰∏™ÂØπË±°
function $(selector) {
    return new DomElement(selector);
}

// Ëß£ÁªëÊâÄÊúâ‰∫ã‰ª∂ÔºåÁî®‰∫éÈîÄÊØÅÁºñËæëÂô®
$.offAll = function () {
    eventList.forEach(function (item) {
        var elem = item.elem;
        var type = item.type;
        var fn = item.fn;
        // Ëß£Áªë
        elem.removeEventListener(type, fn);
    });
};

/*
    ÈÖçÁΩÆ‰ø°ÊÅØ
*/

var config = {

    // ÈªòËÆ§ËèúÂçïÈÖçÁΩÆ
    menus: ['head', 'bold', 'fontSize', 'fontName', 'italic', 'underline', 'strikeThrough', 'foreColor', 'backColor', 'link', 'list', 'justify', 'quote', 'emoticon', 'image', 'table', 'video', 'code', 'undo', 'redo'],

    fontNames: ['ÂÆã‰Ωì', 'ÂæÆËΩØÈõÖÈªë', 'Arial', 'Tahoma', 'Verdana'],

    colors: ['#000000', '#eeece0', '#1c487f', '#4d80bf', '#c24f4a', '#8baa4a', '#7b5ba1', '#46acc8', '#f9963b', '#ffffff'],

    // // ËØ≠Ë®ÄÈÖçÁΩÆ
    // lang: {
    //     'ËÆæÁΩÆÊ†áÈ¢ò': 'title',
    //     'Ê≠£Êñá': 'p',
    //     'ÈìæÊé•ÊñáÂ≠ó': 'link text',
    //     'ÈìæÊé•': 'link',
    //     'ÊèíÂÖ•': 'insert',
    //     'ÂàõÂª∫': 'init'
    // },

    // Ë°®ÊÉÖ
    emotions: [{
        // tab ÁöÑÊ†áÈ¢ò
        title: 'ÈªòËÆ§',
        // type -> 'emoji' / 'image'
        type: 'image',
        // content -> Êï∞ÁªÑ
        content: [{
            alt: '[ÂùèÁ¨ë]',
            src: 'http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/50/pcmoren_huaixiao_org.png'
        }, {
            alt: '[ËàîÂ±è]',
            src: 'http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/pcmoren_tian_org.png'
        }, {
            alt: '[Ê±°]',
            src: 'http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/3c/pcmoren_wu_org.png'
        }]
    }, {
        // tab ÁöÑÊ†áÈ¢ò
        title: 'Êñ∞Êµ™',
        // type -> 'emoji' / 'image'
        type: 'image',
        // content -> Êï∞ÁªÑ
        content: [{
            src: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/7a/shenshou_thumb.gif',
            alt: '[ËçâÊ≥•È©¨]'
        }, {
            src: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/60/horse2_thumb.gif',
            alt: '[Á•ûÈ©¨]'
        }, {
            src: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/fuyun_thumb.gif',
            alt: '[ÊµÆ‰∫ë]'
        }]
    }, {
        // tab ÁöÑÊ†áÈ¢ò
        title: 'emoji',
        // type -> 'emoji' / 'image'
        type: 'emoji',
        // content -> Êï∞ÁªÑ
        content: 'üòÄ üòÉ üòÑ üòÅ üòÜ üòÖ üòÇ üòä üòá üôÇ üôÉ üòâ üòì üò™ üò¥ üôÑ ü§î üò¨ ü§ê'.split(/\s/)
    }],

    // ÁºñËæëÂå∫ÂüüÁöÑ z-index
    zIndex: 10000,

    // ÊòØÂê¶ÂºÄÂêØ debug Ê®°ÂºèÔºàdebug Ê®°Âºè‰∏ãÈîôËØØ‰ºö throw error ÂΩ¢ÂºèÊäõÂá∫Ôºâ
    debug: false,

    // ÊèíÂÖ•ÈìæÊé•Êó∂ÂÄôÁöÑÊ†ºÂºèÊ†°È™å
    linkCheck: function linkCheck(text, link) {
        // text ÊòØÊèíÂÖ•ÁöÑÊñáÂ≠ó
        // link ÊòØÊèíÂÖ•ÁöÑÈìæÊé•
        return true; // ËøîÂõû true Âç≥Ë°®Á§∫ÊàêÂäü
        // return 'Ê†°È™åÂ§±Ë¥•' // ËøîÂõûÂ≠óÁ¨¶‰∏≤Âç≥Ë°®Á§∫Â§±Ë¥•ÁöÑÊèêÁ§∫‰ø°ÊÅØ
    },

    // ÊèíÂÖ•ÁΩëÁªúÂõæÁâáÁöÑÊ†°È™å
    linkImgCheck: function linkImgCheck(src) {
        // src Âç≥ÂõæÁâáÁöÑÂú∞ÂùÄ
        return true; // ËøîÂõû true Âç≥Ë°®Á§∫ÊàêÂäü
        // return 'Ê†°È™åÂ§±Ë¥•'  // ËøîÂõûÂ≠óÁ¨¶‰∏≤Âç≥Ë°®Á§∫Â§±Ë¥•ÁöÑÊèêÁ§∫‰ø°ÊÅØ
    },

    // Á≤òË¥¥ËøáÊª§Ê†∑ÂºèÔºåÈªòËÆ§ÂºÄÂêØ
    pasteFilterStyle: true,

    // Á≤òË¥¥ÂÜÖÂÆπÊó∂ÔºåÂøΩÁï•ÂõæÁâá„ÄÇÈªòËÆ§ÂÖ≥Èó≠
    pasteIgnoreImg: false,

    // ÂØπÁ≤òË¥¥ÁöÑÊñáÂ≠óËøõË°åËá™ÂÆö‰πâÂ§ÑÁêÜÔºåËøîÂõûÂ§ÑÁêÜÂêéÁöÑÁªìÊûú„ÄÇÁºñËæëÂô®‰ºöÂ∞ÜÂ§ÑÁêÜÂêéÁöÑÁªìÊûúÁ≤òË¥¥Âà∞ÁºñËæëÂå∫Âüü‰∏≠„ÄÇ
    // IE ÊöÇÊó∂‰∏çÊîØÊåÅ
    pasteTextHandle: function pasteTextHandle(content) {
        // content Âç≥Á≤òË¥¥ËøáÊù•ÁöÑÂÜÖÂÆπÔºàhtml Êàñ Á∫ØÊñáÊú¨ÔºâÔºåÂèØËøõË°åËá™ÂÆö‰πâÂ§ÑÁêÜÁÑ∂ÂêéËøîÂõû
        return content;
    },

    // onchange ‰∫ã‰ª∂
    // onchange: function (html) {
    //     // html Âç≥ÂèòÂåñ‰πãÂêéÁöÑÂÜÖÂÆπ
    //     console.log(html)
    // },

    // ÊòØÂê¶ÊòæÁ§∫Ê∑ªÂä†ÁΩëÁªúÂõæÁâáÁöÑ tab
    showLinkImg: true,

    // ÊèíÂÖ•ÁΩëÁªúÂõæÁâáÁöÑÂõûË∞É
    linkImgCallback: function linkImgCallback(url) {
        // console.log(url)  // url Âç≥ÊèíÂÖ•ÂõæÁâáÁöÑÂú∞ÂùÄ
    },

    // ÈªòËÆ§‰∏ä‰º†ÂõæÁâá max size: 5M
    uploadImgMaxSize: 5 * 1024 * 1024,

    // ÈÖçÁΩÆ‰∏ÄÊ¨°ÊúÄÂ§ö‰∏ä‰º†Âá†‰∏™ÂõæÁâá
    // uploadImgMaxLength: 5,

    // ‰∏ä‰º†ÂõæÁâáÔºåÊòØÂê¶ÊòæÁ§∫ base64 Ê†ºÂºè
    uploadImgShowBase64: false,

    // ‰∏ä‰º†ÂõæÁâáÔºåserver Âú∞ÂùÄÔºàÂ¶ÇÊûúÊúâÂÄºÔºåÂàô base64 Ê†ºÂºèÁöÑÈÖçÁΩÆÂàôÂ§±ÊïàÔºâ
    // uploadImgServer: '/upload',

    // Ëá™ÂÆö‰πâÈÖçÁΩÆ filename
    uploadFileName: '',

    // ‰∏ä‰º†ÂõæÁâáÁöÑËá™ÂÆö‰πâÂèÇÊï∞
    uploadImgParams: {
        // token: 'abcdef12345'
    },

    // ‰∏ä‰º†ÂõæÁâáÁöÑËá™ÂÆö‰πâheader
    uploadImgHeaders: {
        // 'Accept': 'text/x-json'
    },

    // ÈÖçÁΩÆ XHR withCredentials
    withCredentials: false,

    // Ëá™ÂÆö‰πâ‰∏ä‰º†ÂõæÁâáË∂ÖÊó∂Êó∂Èó¥ ms
    uploadImgTimeout: 10000,

    // ‰∏ä‰º†ÂõæÁâá hook 
    uploadImgHooks: {
        // customInsert: function (insertLinkImg, result, editor) {
        //     console.log('customInsert')
        //     // ÂõæÁâá‰∏ä‰º†Âπ∂ËøîÂõûÁªìÊûúÔºåËá™ÂÆö‰πâÊèíÂÖ•ÂõæÁâáÁöÑ‰∫ã‰ª∂ÔºåËÄå‰∏çÊòØÁºñËæëÂô®Ëá™Âä®ÊèíÂÖ•ÂõæÁâá
        //     const data = result.data1 || []
        //     data.forEach(link => {
        //         insertLinkImg(link)
        //     })
        // },
        before: function before(xhr, editor, files) {
            // ÂõæÁâá‰∏ä‰º†‰πãÂâçËß¶Âèë

            // Â¶ÇÊûúËøîÂõûÁöÑÁªìÊûúÊòØ {prevent: true, msg: 'xxxx'} ÂàôË°®Á§∫Áî®Êà∑ÊîæÂºÉ‰∏ä‰º†
            // return {
            //     prevent: true,
            //     msg: 'ÊîæÂºÉ‰∏ä‰º†'
            // }
        },
        success: function success(xhr, editor, result) {
            // ÂõæÁâá‰∏ä‰º†Âπ∂ËøîÂõûÁªìÊûúÔºåÂõæÁâáÊèíÂÖ•ÊàêÂäü‰πãÂêéËß¶Âèë
        },
        fail: function fail(xhr, editor, result) {
            // ÂõæÁâá‰∏ä‰º†Âπ∂ËøîÂõûÁªìÊûúÔºå‰ΩÜÂõæÁâáÊèíÂÖ•ÈîôËØØÊó∂Ëß¶Âèë
        },
        error: function error(xhr, editor) {
            // ÂõæÁâá‰∏ä‰º†Âá∫ÈîôÊó∂Ëß¶Âèë
        },
        timeout: function timeout(xhr, editor) {
            // ÂõæÁâá‰∏ä‰º†Ë∂ÖÊó∂Êó∂Ëß¶Âèë
        }
    },

    // ÊòØÂê¶‰∏ä‰º†‰∏ÉÁâõ‰∫ëÔºåÈªòËÆ§‰∏∫ false
    qiniu: false

};

/*
    Â∑•ÂÖ∑
*/

// Âíå UA Áõ∏ÂÖ≥ÁöÑÂ±ûÊÄß
var UA = {
    _ua: navigator.userAgent,

    // ÊòØÂê¶ webkit
    isWebkit: function isWebkit() {
        var reg = /webkit/i;
        return reg.test(this._ua);
    },

    // ÊòØÂê¶ IE
    isIE: function isIE() {
        return 'ActiveXObject' in window;
    }
};

// ÈÅçÂéÜÂØπË±°
function objForEach(obj, fn) {
    var key = void 0,
        result = void 0;
    for (key in obj) {
        if (obj.hasOwnProperty(key)) {
            result = fn.call(obj, key, obj[key]);
            if (result === false) {
                break;
            }
        }
    }
}

// ÈÅçÂéÜÁ±ªÊï∞ÁªÑ
function arrForEach(fakeArr, fn) {
    var i = void 0,
        item = void 0,
        result = void 0;
    var length = fakeArr.length || 0;
    for (i = 0; i < length; i++) {
        item = fakeArr[i];
        result = fn.call(fakeArr, item, i);
        if (result === false) {
            break;
        }
    }
}

// Ëé∑ÂèñÈöèÊú∫Êï∞
function getRandom(prefix) {
    return prefix + Math.random().toString().slice(2);
}

// ÊõøÊç¢ html ÁâπÊÆäÂ≠óÁ¨¶
function replaceHtmlSymbol(html) {
    if (html == null) {
        return '';
    }
    return html.replace(/</gm, '&lt;').replace(/>/gm, '&gt;').replace(/"/gm, '&quot;').replace(/(\r\n|\r|\n)/g, '<br/>');
}

// ËøîÂõûÁôæÂàÜÊØîÁöÑÊ†ºÂºè


// Âà§Êñ≠ÊòØ‰∏çÊòØ function
function isFunction(fn) {
    return typeof fn === 'function';
}

/*
    bold-menu
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Bold(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-bold"></i>\n        </div>');
    this.type = 'click';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Bold.prototype = {
    constructor: Bold,

    // ÁÇπÂáª‰∫ã‰ª∂
    onClick: function onClick(e) {
        // ÁÇπÂáªËèúÂçïÂ∞ÜËß¶ÂèëËøôÈáå

        var editor = this.editor;
        var isSeleEmpty = editor.selection.isSelectionEmpty();

        if (isSeleEmpty) {
            // ÈÄâÂå∫ÊòØÁ©∫ÁöÑÔºåÊèíÂÖ•Âπ∂ÈÄâ‰∏≠‰∏Ä‰∏™‚ÄúÁ©∫ÁôΩ‚Äù
            editor.selection.createEmptyRange();
        }

        // ÊâßË°å bold ÂëΩ‰ª§
        editor.cmd.do('bold');

        if (isSeleEmpty) {
            // ÈúÄË¶ÅÂ∞ÜÈÄâÂèñÊäòÂè†Ëµ∑Êù•
            editor.selection.collapseRange();
            editor.selection.restoreSelection();
        }
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        if (editor.cmd.queryCommandState('bold')) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    ÊõøÊç¢Â§öËØ≠Ë®Ä
 */

var replaceLang = function (editor, str) {
    var langArgs = editor.config.langArgs || [];
    var result = str;

    langArgs.forEach(function (item) {
        var reg = item.reg;
        var val = item.val;

        if (reg.test(result)) {
            result = result.replace(reg, function () {
                return val;
            });
        }
    });

    return result;
};

/*
    droplist
*/
var _emptyFn = function _emptyFn() {};

// ÊûÑÈÄ†ÂáΩÊï∞
function DropList(menu, opt) {
    var _this = this;

    // droplist ÊâÄ‰æùÈôÑÁöÑËèúÂçï
    var editor = menu.editor;
    this.menu = menu;
    this.opt = opt;
    // ÂÆπÂô®
    var $container = $('<div class="w-e-droplist"></div>');

    // Ê†áÈ¢ò
    var $title = opt.$title;
    var titleHtml = void 0;
    if ($title) {
        // ÊõøÊç¢Â§öËØ≠Ë®Ä
        titleHtml = $title.html();
        titleHtml = replaceLang(editor, titleHtml);
        $title.html(titleHtml);

        $title.addClass('w-e-dp-title');
        $container.append($title);
    }

    var list = opt.list || [];
    var type = opt.type || 'list'; // 'list' ÂàóË°®ÂΩ¢ÂºèÔºàÂ¶Ç‚ÄúÊ†áÈ¢ò‚ÄùËèúÂçïÔºâ / 'inline-block' ÂùóÁä∂ÂΩ¢ÂºèÔºàÂ¶Ç‚ÄúÈ¢úËâ≤‚ÄùËèúÂçïÔºâ
    var onClick = opt.onClick || _emptyFn;

    // Âä†ÂÖ• DOM Âπ∂ÁªëÂÆö‰∫ã‰ª∂
    var $list = $('<ul class="' + (type === 'list' ? 'w-e-list' : 'w-e-block') + '"></ul>');
    $container.append($list);
    list.forEach(function (item) {
        var $elem = item.$elem;

        // ÊõøÊç¢Â§öËØ≠Ë®Ä
        var elemHtml = $elem.html();
        elemHtml = replaceLang(editor, elemHtml);
        $elem.html(elemHtml);

        var value = item.value;
        var $li = $('<li class="w-e-item"></li>');
        if ($elem) {
            $li.append($elem);
            $list.append($li);
            $li.on('click', function (e) {
                onClick(value);

                // ÈöêËóè
                _this.hideTimeoutId = setTimeout(function () {
                    _this.hide();
                }, 0);
            });
        }
    });

    // ÁªëÂÆöÈöêËóè‰∫ã‰ª∂
    $container.on('mouseleave', function (e) {
        _this.hideTimeoutId = setTimeout(function () {
            _this.hide();
        }, 0);
    });

    // ËÆ∞ÂΩïÂ±ûÊÄß
    this.$container = $container;

    // Âü∫Êú¨Â±ûÊÄß
    this._rendered = false;
    this._show = false;
}

// ÂéüÂûã
DropList.prototype = {
    constructor: DropList,

    // ÊòæÁ§∫ÔºàÊèíÂÖ•DOMÔºâ
    show: function show() {
        if (this.hideTimeoutId) {
            // Ê∏ÖÈô§‰πãÂâçÁöÑÂÆöÊó∂ÈöêËóè
            clearTimeout(this.hideTimeoutId);
        }

        var menu = this.menu;
        var $menuELem = menu.$elem;
        var $container = this.$container;
        if (this._show) {
            return;
        }
        if (this._rendered) {
            // ÊòæÁ§∫
            $container.show();
        } else {
            // Âä†ÂÖ• DOM ‰πãÂâçÂÖàÂÆö‰Ωç‰ΩçÁΩÆ
            var menuHeight = $menuELem.getSizeData().height || 0;
            var width = this.opt.width || 100; // ÈªòËÆ§‰∏∫ 100
            $container.css('margin-top', menuHeight + 'px').css('width', width + 'px');

            // Âä†ÂÖ•Âà∞ DOM
            $menuELem.append($container);
            this._rendered = true;
        }

        // ‰øÆÊîπÂ±ûÊÄß
        this._show = true;
    },

    // ÈöêËóèÔºàÁßªÈô§DOMÔºâ
    hide: function hide() {
        if (this.showTimeoutId) {
            // Ê∏ÖÈô§‰πãÂâçÁöÑÂÆöÊó∂ÊòæÁ§∫
            clearTimeout(this.showTimeoutId);
        }

        var $container = this.$container;
        if (!this._show) {
            return;
        }
        // ÈöêËóèÂπ∂ÈúÄÊîπÂ±ûÊÄß
        $container.hide();
        this._show = false;
    }
};

/*
    menu - header
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Head(editor) {
    var _this = this;

    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-header"></i></div>');
    this.type = 'droplist';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;

    // ÂàùÂßãÂåñ droplist
    this.droplist = new DropList(this, {
        width: 100,
        $title: $('<p>ËÆæÁΩÆÊ†áÈ¢ò</p>'),
        type: 'list', // droplist ‰ª•ÂàóË°®ÂΩ¢ÂºèÂ±ïÁ§∫
        list: [{ $elem: $('<h1>H1</h1>'), value: '<h1>' }, { $elem: $('<h2>H2</h2>'), value: '<h2>' }, { $elem: $('<h3>H3</h3>'), value: '<h3>' }, { $elem: $('<h4>H4</h4>'), value: '<h4>' }, { $elem: $('<h5>H5</h5>'), value: '<h5>' }, { $elem: $('<p>Ê≠£Êñá</p>'), value: '<p>' }],
        onClick: function onClick(value) {
            // Ê≥®ÊÑè this ÊòØÊåáÂêëÂΩìÂâçÁöÑ Head ÂØπË±°
            _this._command(value);
        }
    });
}

// ÂéüÂûã
Head.prototype = {
    constructor: Head,

    // ÊâßË°åÂëΩ‰ª§
    _command: function _command(value) {
        var editor = this.editor;

        var $selectionElem = editor.selection.getSelectionContainerElem();
        if (editor.$textElem.equal($selectionElem)) {
            // ‰∏çËÉΩÈÄâ‰∏≠Â§öË°åÊù•ËÆæÁΩÆÊ†áÈ¢òÔºåÂê¶Âàô‰ºöÂá∫Áé∞ÈóÆÈ¢ò
            // ‰æãÂ¶ÇÈÄâ‰∏≠ÁöÑÊòØ <p>xxx</p><p>yyy</p> Êù•ËÆæÁΩÆÊ†áÈ¢òÔºåËÆæÁΩÆ‰πãÂêé‰ºöÊàê‰∏∫ <h1>xxx<br>yyy</h1> ‰∏çÁ¨¶ÂêàÈ¢ÑÊúü
            return;
        }

        editor.cmd.do('formatBlock', value);
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        var reg = /^h/i;
        var cmdValue = editor.cmd.queryCommandValue('formatBlock');
        if (reg.test(cmdValue)) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    menu - fontSize
*/

// ÊûÑÈÄ†ÂáΩÊï∞
function FontSize(editor) {
    var _this = this;

    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-text-heigh"></i></div>');
    this.type = 'droplist';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;

    // ÂàùÂßãÂåñ droplist
    this.droplist = new DropList(this, {
        width: 160,
        $title: $('<p>Â≠óÂè∑</p>'),
        type: 'list', // droplist ‰ª•ÂàóË°®ÂΩ¢ÂºèÂ±ïÁ§∫
        list: [{ $elem: $('<span style="font-size: x-small;">x-small</span>'), value: '1' }, { $elem: $('<span style="font-size: small;">small</span>'), value: '2' }, { $elem: $('<span>normal</span>'), value: '3' }, { $elem: $('<span style="font-size: large;">large</span>'), value: '4' }, { $elem: $('<span style="font-size: x-large;">x-large</span>'), value: '5' }, { $elem: $('<span style="font-size: xx-large;">xx-large</span>'), value: '6' }],
        onClick: function onClick(value) {
            // Ê≥®ÊÑè this ÊòØÊåáÂêëÂΩìÂâçÁöÑ FontSize ÂØπË±°
            _this._command(value);
        }
    });
}

// ÂéüÂûã
FontSize.prototype = {
    constructor: FontSize,

    // ÊâßË°åÂëΩ‰ª§
    _command: function _command(value) {
        var editor = this.editor;
        editor.cmd.do('fontSize', value);
    }
};

/*
    menu - fontName
*/

// ÊûÑÈÄ†ÂáΩÊï∞
function FontName(editor) {
    var _this = this;

    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-font"></i></div>');
    this.type = 'droplist';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;

    // Ëé∑ÂèñÈÖçÁΩÆÁöÑÂ≠ó‰Ωì
    var config = editor.config;
    var fontNames = config.fontNames || [];

    // ÂàùÂßãÂåñ droplist
    this.droplist = new DropList(this, {
        width: 100,
        $title: $('<p>Â≠ó‰Ωì</p>'),
        type: 'list', // droplist ‰ª•ÂàóË°®ÂΩ¢ÂºèÂ±ïÁ§∫
        list: fontNames.map(function (fontName) {
            return { $elem: $('<span style="font-family: ' + fontName + ';">' + fontName + '</span>'), value: fontName };
        }),
        onClick: function onClick(value) {
            // Ê≥®ÊÑè this ÊòØÊåáÂêëÂΩìÂâçÁöÑ FontName ÂØπË±°
            _this._command(value);
        }
    });
}

// ÂéüÂûã
FontName.prototype = {
    constructor: FontName,

    _command: function _command(value) {
        var editor = this.editor;
        editor.cmd.do('fontName', value);
    }
};

/*
    panel
*/

var emptyFn = function emptyFn() {};

// ËÆ∞ÂΩïÂ∑≤ÁªèÊòæÁ§∫ panel ÁöÑËèúÂçï
var _isCreatedPanelMenus = [];

// ÊûÑÈÄ†ÂáΩÊï∞
function Panel(menu, opt) {
    this.menu = menu;
    this.opt = opt;
}

// ÂéüÂûã
Panel.prototype = {
    constructor: Panel,

    // ÊòæÁ§∫ÔºàÊèíÂÖ•DOMÔºâ
    show: function show() {
        var _this = this;

        var menu = this.menu;
        if (_isCreatedPanelMenus.indexOf(menu) >= 0) {
            // ËØ•ËèúÂçïÂ∑≤ÁªèÂàõÂª∫‰∫Ü panel ‰∏çËÉΩÂÜçÂàõÂª∫
            return;
        }

        var editor = menu.editor;
        var $body = $('body');
        var $textContainerElem = editor.$textContainerElem;
        var opt = this.opt;

        // panel ÁöÑÂÆπÂô®
        var $container = $('<div class="w-e-panel-container"></div>');
        var width = opt.width || 300; // ÈªòËÆ§ 300px
        $container.css('width', width + 'px').css('margin-left', (0 - width) / 2 + 'px');

        // Ê∑ªÂä†ÂÖ≥Èó≠ÊåâÈíÆ
        var $closeBtn = $('<i class="w-e-icon-close w-e-panel-close"></i>');
        $container.append($closeBtn);
        $closeBtn.on('click', function () {
            _this.hide();
        });

        // ÂáÜÂ§á tabs ÂÆπÂô®
        var $tabTitleContainer = $('<ul class="w-e-panel-tab-title"></ul>');
        var $tabContentContainer = $('<div class="w-e-panel-tab-content"></div>');
        $container.append($tabTitleContainer).append($tabContentContainer);

        // ËÆæÁΩÆÈ´òÂ∫¶
        var height = opt.height;
        if (height) {
            $tabContentContainer.css('height', height + 'px').css('overflow-y', 'auto');
        }

        // tabs
        var tabs = opt.tabs || [];
        var tabTitleArr = [];
        var tabContentArr = [];
        tabs.forEach(function (tab, tabIndex) {
            if (!tab) {
                return;
            }
            var title = tab.title || '';
            var tpl = tab.tpl || '';

            // ÊõøÊç¢Â§öËØ≠Ë®Ä
            title = replaceLang(editor, title);
            tpl = replaceLang(editor, tpl);

            // Ê∑ªÂä†Âà∞ DOM
            var $title = $('<li class="w-e-item">' + title + '</li>');
            $tabTitleContainer.append($title);
            var $content = $(tpl);
            $tabContentContainer.append($content);

            // ËÆ∞ÂΩïÂà∞ÂÜÖÂ≠ò
            $title._index = tabIndex;
            tabTitleArr.push($title);
            tabContentArr.push($content);

            // ËÆæÁΩÆ active È°π
            if (tabIndex === 0) {
                $title._active = true;
                $title.addClass('w-e-active');
            } else {
                $content.hide();
            }

            // ÁªëÂÆö tab ÁöÑ‰∫ã‰ª∂
            $title.on('click', function (e) {
                if ($title._active) {
                    return;
                }
                // ÈöêËóèÊâÄÊúâÁöÑ tab
                tabTitleArr.forEach(function ($title) {
                    $title._active = false;
                    $title.removeClass('w-e-active');
                });
                tabContentArr.forEach(function ($content) {
                    $content.hide();
                });

                // ÊòæÁ§∫ÂΩìÂâçÁöÑ tab
                $title._active = true;
                $title.addClass('w-e-active');
                $content.show();
            });
        });

        // ÁªëÂÆöÂÖ≥Èó≠‰∫ã‰ª∂
        $container.on('click', function (e) {
            // ÁÇπÂáªÊó∂ÈòªÊ≠¢ÂÜíÊ≥°
            e.stopPropagation();
        });
        $body.on('click', function (e) {
            _this.hide();
        });

        // Ê∑ªÂä†Âà∞ DOM
        $textContainerElem.append($container);

        // ÁªëÂÆö opt ÁöÑ‰∫ã‰ª∂ÔºåÂè™ÊúâÊ∑ªÂä†Âà∞ DOM ‰πãÂêéÊâçËÉΩÁªëÂÆöÊàêÂäü
        tabs.forEach(function (tab, index) {
            if (!tab) {
                return;
            }
            var events = tab.events || [];
            events.forEach(function (event) {
                var selector = event.selector;
                var type = event.type;
                var fn = event.fn || emptyFn;
                var $content = tabContentArr[index];
                $content.find(selector).on(type, function (e) {
                    e.stopPropagation();
                    var needToHide = fn(e);
                    // ÊâßË°åÂÆå‰∫ã‰ª∂‰πãÂêéÔºåÊòØÂê¶Ë¶ÅÂÖ≥Èó≠ panel
                    if (needToHide) {
                        _this.hide();
                    }
                });
            });
        });

        // focus Á¨¨‰∏Ä‰∏™ elem
        var $inputs = $container.find('input[type=text],textarea');
        if ($inputs.length) {
            $inputs.get(0).focus();
        }

        // Ê∑ªÂä†Âà∞Â±ûÊÄß
        this.$container = $container;

        // ÈöêËóèÂÖ∂‰ªñ panel
        this._hideOtherPanels();
        // ËÆ∞ÂΩïËØ• menu Â∑≤ÁªèÂàõÂª∫‰∫Ü panel
        _isCreatedPanelMenus.push(menu);
    },

    // ÈöêËóèÔºàÁßªÈô§DOMÔºâ
    hide: function hide() {
        var menu = this.menu;
        var $container = this.$container;
        if ($container) {
            $container.remove();
        }

        // Â∞ÜËØ• menu ËÆ∞ÂΩï‰∏≠ÁßªÈô§
        _isCreatedPanelMenus = _isCreatedPanelMenus.filter(function (item) {
            if (item === menu) {
                return false;
            } else {
                return true;
            }
        });
    },

    // ‰∏Ä‰∏™ panel Â±ïÁ§∫Êó∂ÔºåÈöêËóèÂÖ∂‰ªñ panel
    _hideOtherPanels: function _hideOtherPanels() {
        if (!_isCreatedPanelMenus.length) {
            return;
        }
        _isCreatedPanelMenus.forEach(function (menu) {
            var panel = menu.panel || {};
            if (panel.hide) {
                panel.hide();
            }
        });
    }
};

/*
    menu - link
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Link(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-link"></i></div>');
    this.type = 'panel';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Link.prototype = {
    constructor: Link,

    // ÁÇπÂáª‰∫ã‰ª∂
    onClick: function onClick(e) {
        var editor = this.editor;
        var $linkelem = void 0;

        if (this._active) {
            // ÂΩìÂâçÈÄâÂå∫Âú®ÈìæÊé•ÈáåÈù¢
            $linkelem = editor.selection.getSelectionContainerElem();
            if (!$linkelem) {
                return;
            }
            // Â∞ÜËØ•ÂÖÉÁ¥†ÈÉΩÂåÖÂê´Âú®ÈÄâÂèñ‰πãÂÜÖÔºå‰ª•‰æøÂêéÈù¢Êï¥‰ΩìÊõøÊç¢
            editor.selection.createRangeByElem($linkelem);
            editor.selection.restoreSelection();
            // ÊòæÁ§∫ panel
            this._createPanel($linkelem.text(), $linkelem.attr('href'));
        } else {
            // ÂΩìÂâçÈÄâÂå∫‰∏çÂú®ÈìæÊé•ÈáåÈù¢
            if (editor.selection.isSelectionEmpty()) {
                // ÈÄâÂå∫ÊòØÁ©∫ÁöÑÔºåÊú™ÈÄâ‰∏≠ÂÜÖÂÆπ
                this._createPanel('', '');
            } else {
                // ÈÄâ‰∏≠ÂÜÖÂÆπ‰∫Ü
                this._createPanel(editor.selection.getSelectionText(), '');
            }
        }
    },

    // ÂàõÂª∫ panel
    _createPanel: function _createPanel(text, link) {
        var _this = this;

        // panel ‰∏≠ÈúÄË¶ÅÁî®Âà∞ÁöÑid
        var inputLinkId = getRandom('input-link');
        var inputTextId = getRandom('input-text');
        var btnOkId = getRandom('btn-ok');
        var btnDelId = getRandom('btn-del');

        // ÊòØÂê¶ÊòæÁ§∫‚ÄúÂà†Èô§ÈìæÊé•‚Äù
        var delBtnDisplay = this._active ? 'inline-block' : 'none';

        // ÂàùÂßãÂåñÂπ∂ÊòæÁ§∫ panel
        var panel = new Panel(this, {
            width: 300,
            // panel ‰∏≠ÂèØÂåÖÂê´Â§ö‰∏™ tab
            tabs: [{
                // tab ÁöÑÊ†áÈ¢ò
                title: 'ÈìæÊé•',
                // Ê®°Êùø
                tpl: '<div>\n                            <input id="' + inputTextId + '" type="text" class="block" value="' + text + '" placeholder="\u94FE\u63A5\u6587\u5B57"/></td>\n                            <input id="' + inputLinkId + '" type="text" class="block" value="' + link + '" placeholder="http://..."/></td>\n                            <div class="w-e-button-container">\n                                <button id="' + btnOkId + '" class="right">\u63D2\u5165</button>\n                                <button id="' + btnDelId + '" class="gray right" style="display:' + delBtnDisplay + '">\u5220\u9664\u94FE\u63A5</button>\n                            </div>\n                        </div>',
                // ‰∫ã‰ª∂ÁªëÂÆö
                events: [
                // ÊèíÂÖ•ÈìæÊé•
                {
                    selector: '#' + btnOkId,
                    type: 'click',
                    fn: function fn() {
                        // ÊâßË°åÊèíÂÖ•ÈìæÊé•
                        var $link = $('#' + inputLinkId);
                        var $text = $('#' + inputTextId);
                        var link = $link.val();
                        var text = $text.val();
                        _this._insertLink(text, link);

                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                },
                // Âà†Èô§ÈìæÊé•
                {
                    selector: '#' + btnDelId,
                    type: 'click',
                    fn: function fn() {
                        // ÊâßË°åÂà†Èô§ÈìæÊé•
                        _this._delLink();

                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }]
            } // tab end
            ] // tabs end
        });

        // ÊòæÁ§∫ panel
        panel.show();

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.panel = panel;
    },

    // Âà†Èô§ÂΩìÂâçÈìæÊé•
    _delLink: function _delLink() {
        if (!this._active) {
            return;
        }
        var editor = this.editor;
        var $selectionELem = editor.selection.getSelectionContainerElem();
        if (!$selectionELem) {
            return;
        }
        var selectionText = editor.selection.getSelectionText();
        editor.cmd.do('insertHTML', '<span>' + selectionText + '</span>');
    },

    // ÊèíÂÖ•ÈìæÊé•
    _insertLink: function _insertLink(text, link) {
        var editor = this.editor;
        var config = editor.config;
        var linkCheck = config.linkCheck;
        var checkResult = true; // ÈªòËÆ§‰∏∫ true
        if (linkCheck && typeof linkCheck === 'function') {
            checkResult = linkCheck(text, link);
        }
        if (checkResult === true) {
            editor.cmd.do('insertHTML', '<a href="' + link + '" target="_blank">' + text + '</a>');
        } else {
            alert(checkResult);
        }
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        var $selectionELem = editor.selection.getSelectionContainerElem();
        if (!$selectionELem) {
            return;
        }
        if ($selectionELem.getNodeName() === 'A') {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    italic-menu
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Italic(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-italic"></i>\n        </div>');
    this.type = 'click';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Italic.prototype = {
    constructor: Italic,

    // ÁÇπÂáª‰∫ã‰ª∂
    onClick: function onClick(e) {
        // ÁÇπÂáªËèúÂçïÂ∞ÜËß¶ÂèëËøôÈáå

        var editor = this.editor;
        var isSeleEmpty = editor.selection.isSelectionEmpty();

        if (isSeleEmpty) {
            // ÈÄâÂå∫ÊòØÁ©∫ÁöÑÔºåÊèíÂÖ•Âπ∂ÈÄâ‰∏≠‰∏Ä‰∏™‚ÄúÁ©∫ÁôΩ‚Äù
            editor.selection.createEmptyRange();
        }

        // ÊâßË°å italic ÂëΩ‰ª§
        editor.cmd.do('italic');

        if (isSeleEmpty) {
            // ÈúÄË¶ÅÂ∞ÜÈÄâÂèñÊäòÂè†Ëµ∑Êù•
            editor.selection.collapseRange();
            editor.selection.restoreSelection();
        }
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        if (editor.cmd.queryCommandState('italic')) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    redo-menu
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Redo(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-redo"></i>\n        </div>');
    this.type = 'click';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Redo.prototype = {
    constructor: Redo,

    // ÁÇπÂáª‰∫ã‰ª∂
    onClick: function onClick(e) {
        // ÁÇπÂáªËèúÂçïÂ∞ÜËß¶ÂèëËøôÈáå

        var editor = this.editor;

        // ÊâßË°å redo ÂëΩ‰ª§
        editor.cmd.do('redo');
    }
};

/*
    strikeThrough-menu
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function StrikeThrough(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-strikethrough"></i>\n        </div>');
    this.type = 'click';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
StrikeThrough.prototype = {
    constructor: StrikeThrough,

    // ÁÇπÂáª‰∫ã‰ª∂
    onClick: function onClick(e) {
        // ÁÇπÂáªËèúÂçïÂ∞ÜËß¶ÂèëËøôÈáå

        var editor = this.editor;
        var isSeleEmpty = editor.selection.isSelectionEmpty();

        if (isSeleEmpty) {
            // ÈÄâÂå∫ÊòØÁ©∫ÁöÑÔºåÊèíÂÖ•Âπ∂ÈÄâ‰∏≠‰∏Ä‰∏™‚ÄúÁ©∫ÁôΩ‚Äù
            editor.selection.createEmptyRange();
        }

        // ÊâßË°å strikeThrough ÂëΩ‰ª§
        editor.cmd.do('strikeThrough');

        if (isSeleEmpty) {
            // ÈúÄË¶ÅÂ∞ÜÈÄâÂèñÊäòÂè†Ëµ∑Êù•
            editor.selection.collapseRange();
            editor.selection.restoreSelection();
        }
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        if (editor.cmd.queryCommandState('strikeThrough')) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    underline-menu
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Underline(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-underline"></i>\n        </div>');
    this.type = 'click';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Underline.prototype = {
    constructor: Underline,

    // ÁÇπÂáª‰∫ã‰ª∂
    onClick: function onClick(e) {
        // ÁÇπÂáªËèúÂçïÂ∞ÜËß¶ÂèëËøôÈáå

        var editor = this.editor;
        var isSeleEmpty = editor.selection.isSelectionEmpty();

        if (isSeleEmpty) {
            // ÈÄâÂå∫ÊòØÁ©∫ÁöÑÔºåÊèíÂÖ•Âπ∂ÈÄâ‰∏≠‰∏Ä‰∏™‚ÄúÁ©∫ÁôΩ‚Äù
            editor.selection.createEmptyRange();
        }

        // ÊâßË°å underline ÂëΩ‰ª§
        editor.cmd.do('underline');

        if (isSeleEmpty) {
            // ÈúÄË¶ÅÂ∞ÜÈÄâÂèñÊäòÂè†Ëµ∑Êù•
            editor.selection.collapseRange();
            editor.selection.restoreSelection();
        }
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        if (editor.cmd.queryCommandState('underline')) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    undo-menu
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Undo(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-undo"></i>\n        </div>');
    this.type = 'click';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Undo.prototype = {
    constructor: Undo,

    // ÁÇπÂáª‰∫ã‰ª∂
    onClick: function onClick(e) {
        // ÁÇπÂáªËèúÂçïÂ∞ÜËß¶ÂèëËøôÈáå

        var editor = this.editor;

        // ÊâßË°å undo ÂëΩ‰ª§
        editor.cmd.do('undo');
    }
};

/*
    menu - list
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function List(editor) {
    var _this = this;

    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-list2"></i></div>');
    this.type = 'droplist';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;

    // ÂàùÂßãÂåñ droplist
    this.droplist = new DropList(this, {
        width: 120,
        $title: $('<p>ËÆæÁΩÆÂàóË°®</p>'),
        type: 'list', // droplist ‰ª•ÂàóË°®ÂΩ¢ÂºèÂ±ïÁ§∫
        list: [{ $elem: $('<span><i class="w-e-icon-list-numbered"></i> ÊúâÂ∫èÂàóË°®</span>'), value: 'insertOrderedList' }, { $elem: $('<span><i class="w-e-icon-list2"></i> Êó†Â∫èÂàóË°®</span>'), value: 'insertUnorderedList' }],
        onClick: function onClick(value) {
            // Ê≥®ÊÑè this ÊòØÊåáÂêëÂΩìÂâçÁöÑ List ÂØπË±°
            _this._command(value);
        }
    });
}

// ÂéüÂûã
List.prototype = {
    constructor: List,

    // ÊâßË°åÂëΩ‰ª§
    _command: function _command(value) {
        var editor = this.editor;
        var $textElem = editor.$textElem;
        editor.selection.restoreSelection();
        if (editor.cmd.queryCommandState(value)) {
            return;
        }
        editor.cmd.do(value);

        // È™åËØÅÂàóË°®ÊòØÂê¶Ë¢´ÂåÖË£πÂú® <p> ‰πãÂÜÖ
        var $selectionElem = editor.selection.getSelectionContainerElem();
        if ($selectionElem.getNodeName() === 'LI') {
            $selectionElem = $selectionElem.parent();
        }
        if (/^ol|ul$/i.test($selectionElem.getNodeName()) === false) {
            return;
        }
        if ($selectionElem.equal($textElem)) {
            // ËØÅÊòéÊòØÈ°∂Á∫ßÊ†áÁ≠æÔºåÊ≤°ÊúâË¢´ <p> ÂåÖË£π
            return;
        }
        var $parent = $selectionElem.parent();
        if ($parent.equal($textElem)) {
            // $parent ÊòØÈ°∂Á∫ßÊ†áÁ≠æÔºå‰∏çËÉΩÂà†Èô§
            return;
        }

        $selectionElem.insertAfter($parent);
        $parent.remove();
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        if (editor.cmd.queryCommandState('insertUnOrderedList') || editor.cmd.queryCommandState('insertOrderedList')) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    menu - justify
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Justify(editor) {
    var _this = this;

    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-paragraph-left"></i></div>');
    this.type = 'droplist';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;

    // ÂàùÂßãÂåñ droplist
    this.droplist = new DropList(this, {
        width: 100,
        $title: $('<p>ÂØπÈΩêÊñπÂºè</p>'),
        type: 'list', // droplist ‰ª•ÂàóË°®ÂΩ¢ÂºèÂ±ïÁ§∫
        list: [{ $elem: $('<span><i class="w-e-icon-paragraph-left"></i> Èù†Â∑¶</span>'), value: 'justifyLeft' }, { $elem: $('<span><i class="w-e-icon-paragraph-center"></i> Â±Ö‰∏≠</span>'), value: 'justifyCenter' }, { $elem: $('<span><i class="w-e-icon-paragraph-right"></i> Èù†Âè≥</span>'), value: 'justifyRight' }],
        onClick: function onClick(value) {
            // Ê≥®ÊÑè this ÊòØÊåáÂêëÂΩìÂâçÁöÑ List ÂØπË±°
            _this._command(value);
        }
    });
}

// ÂéüÂûã
Justify.prototype = {
    constructor: Justify,

    // ÊâßË°åÂëΩ‰ª§
    _command: function _command(value) {
        var editor = this.editor;
        editor.cmd.do(value);
    }
};

/*
    menu - Forecolor
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function ForeColor(editor) {
    var _this = this;

    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-pencil2"></i></div>');
    this.type = 'droplist';

    // Ëé∑ÂèñÈÖçÁΩÆÁöÑÈ¢úËâ≤
    var config = editor.config;
    var colors = config.colors || [];

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;

    // ÂàùÂßãÂåñ droplist
    this.droplist = new DropList(this, {
        width: 120,
        $title: $('<p>ÊñáÂ≠óÈ¢úËâ≤</p>'),
        type: 'inline-block', // droplist ÂÜÖÂÆπ‰ª• block ÂΩ¢ÂºèÂ±ïÁ§∫
        list: colors.map(function (color) {
            return { $elem: $('<i style="color:' + color + ';" class="w-e-icon-pencil2"></i>'), value: color };
        }),
        onClick: function onClick(value) {
            // Ê≥®ÊÑè this ÊòØÊåáÂêëÂΩìÂâçÁöÑ ForeColor ÂØπË±°
            _this._command(value);
        }
    });
}

// ÂéüÂûã
ForeColor.prototype = {
    constructor: ForeColor,

    // ÊâßË°åÂëΩ‰ª§
    _command: function _command(value) {
        var editor = this.editor;
        editor.cmd.do('foreColor', value);
    }
};

/*
    menu - BackColor
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function BackColor(editor) {
    var _this = this;

    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-paint-brush"></i></div>');
    this.type = 'droplist';

    // Ëé∑ÂèñÈÖçÁΩÆÁöÑÈ¢úËâ≤
    var config = editor.config;
    var colors = config.colors || [];

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;

    // ÂàùÂßãÂåñ droplist
    this.droplist = new DropList(this, {
        width: 120,
        $title: $('<p>ËÉåÊôØËâ≤</p>'),
        type: 'inline-block', // droplist ÂÜÖÂÆπ‰ª• block ÂΩ¢ÂºèÂ±ïÁ§∫
        list: colors.map(function (color) {
            return { $elem: $('<i style="color:' + color + ';" class="w-e-icon-paint-brush"></i>'), value: color };
        }),
        onClick: function onClick(value) {
            // Ê≥®ÊÑè this ÊòØÊåáÂêëÂΩìÂâçÁöÑ BackColor ÂØπË±°
            _this._command(value);
        }
    });
}

// ÂéüÂûã
BackColor.prototype = {
    constructor: BackColor,

    // ÊâßË°åÂëΩ‰ª§
    _command: function _command(value) {
        var editor = this.editor;
        editor.cmd.do('backColor', value);
    }
};

/*
    menu - quote
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Quote(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-quotes-left"></i>\n        </div>');
    this.type = 'click';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Quote.prototype = {
    constructor: Quote,

    onClick: function onClick(e) {
        var editor = this.editor;
        var $selectionElem = editor.selection.getSelectionContainerElem();
        var nodeName = $selectionElem.getNodeName();

        if (!UA.isIE()) {
            if (nodeName === 'BLOCKQUOTE') {
                // Êí§ÈîÄ quote
                editor.cmd.do('formatBlock', '<P>');
            } else {
                // ËΩ¨Êç¢‰∏∫ quote
                editor.cmd.do('formatBlock', '<BLOCKQUOTE>');
            }
            return;
        }

        // IE ‰∏≠‰∏çÊîØÊåÅ formatBlock <BLOCKQUOTE> ÔºåË¶ÅÁî®ÂÖ∂‰ªñÊñπÂºèÂÖºÂÆπ
        var content = void 0,
            $targetELem = void 0;
        if (nodeName === 'P') {
            // Â∞Ü P ËΩ¨Êç¢‰∏∫ quote
            content = $selectionElem.text();
            $targetELem = $('<blockquote>' + content + '</blockquote>');
            $targetELem.insertAfter($selectionElem);
            $selectionElem.remove();
            return;
        }
        if (nodeName === 'BLOCKQUOTE') {
            // Êí§ÈîÄ quote
            content = $selectionElem.text();
            $targetELem = $('<p>' + content + '</p>');
            $targetELem.insertAfter($selectionElem);
            $selectionElem.remove();
        }
    },

    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        var reg = /^BLOCKQUOTE$/i;
        var cmdValue = editor.cmd.queryCommandValue('formatBlock');
        if (reg.test(cmdValue)) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    menu - code
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Code(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-terminal"></i>\n        </div>');
    this.type = 'panel';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Code.prototype = {
    constructor: Code,

    onClick: function onClick(e) {
        var editor = this.editor;
        var $startElem = editor.selection.getSelectionStartElem();
        var $endElem = editor.selection.getSelectionEndElem();
        var isSeleEmpty = editor.selection.isSelectionEmpty();
        var selectionText = editor.selection.getSelectionText();
        var $code = void 0;

        if (!$startElem.equal($endElem)) {
            // Ë∑®ÂÖÉÁ¥†ÈÄâÊã©Ôºå‰∏çÂÅöÂ§ÑÁêÜ
            editor.selection.restoreSelection();
            return;
        }
        if (!isSeleEmpty) {
            // ÈÄâÂèñ‰∏çÊòØÁ©∫ÔºåÁî® <code> ÂåÖË£πÂç≥ÂèØ
            $code = $('<code>' + selectionText + '</code>');
            editor.cmd.do('insertElem', $code);
            editor.selection.createRangeByElem($code, false);
            editor.selection.restoreSelection();
            return;
        }

        // ÈÄâÂèñÊòØÁ©∫Ôºå‰∏îÊ≤°ÊúâÂ§∏ÂÖÉÁ¥†ÈÄâÊã©ÔºåÂàôÊèíÂÖ• <pre><code></code></prev>
        if (this._active) {
            // ÈÄâ‰∏≠Áä∂ÊÄÅÔºåÂ∞ÜÁºñËæëÂÜÖÂÆπ
            this._createPanel($startElem.html());
        } else {
            // Êú™ÈÄâ‰∏≠Áä∂ÊÄÅÔºåÂ∞ÜÂàõÂª∫ÂÜÖÂÆπ
            this._createPanel();
        }
    },

    _createPanel: function _createPanel(value) {
        var _this = this;

        // value - Ë¶ÅÁºñËæëÁöÑÂÜÖÂÆπ
        value = value || '';
        var type = !value ? 'new' : 'edit';
        var textId = getRandom('texxt');
        var btnId = getRandom('btn');

        var panel = new Panel(this, {
            width: 500,
            // ‰∏Ä‰∏™ Panel ÂåÖÂê´Â§ö‰∏™ tab
            tabs: [{
                // Ê†áÈ¢ò
                title: 'ÊèíÂÖ•‰ª£Á†Å',
                // Ê®°Êùø
                tpl: '<div>\n                        <textarea id="' + textId + '" style="height:145px;;">' + value + '</textarea>\n                        <div class="w-e-button-container">\n                            <button id="' + btnId + '" class="right">\u63D2\u5165</button>\n                        </div>\n                    <div>',
                // ‰∫ã‰ª∂ÁªëÂÆö
                events: [
                // ÊèíÂÖ•‰ª£Á†Å
                {
                    selector: '#' + btnId,
                    type: 'click',
                    fn: function fn() {
                        var $text = $('#' + textId);
                        var text = $text.val() || $text.html();
                        text = replaceHtmlSymbol(text);
                        if (type === 'new') {
                            // Êñ∞ÊèíÂÖ•
                            _this._insertCode(text);
                        } else {
                            // ÁºñËæëÊõ¥Êñ∞
                            _this._updateCode(text);
                        }

                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }]
            } // first tab end
            ] // tabs end
        }); // new Panel end

        // ÊòæÁ§∫ panel
        panel.show();

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.panel = panel;
    },

    // ÊèíÂÖ•‰ª£Á†Å
    _insertCode: function _insertCode(value) {
        var editor = this.editor;
        editor.cmd.do('insertHTML', '<pre><code>' + value + '</code></pre><p><br></p>');
    },

    // Êõ¥Êñ∞‰ª£Á†Å
    _updateCode: function _updateCode(value) {
        var editor = this.editor;
        var $selectionELem = editor.selection.getSelectionContainerElem();
        if (!$selectionELem) {
            return;
        }
        $selectionELem.html(value);
        editor.selection.restoreSelection();
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        var $selectionELem = editor.selection.getSelectionContainerElem();
        if (!$selectionELem) {
            return;
        }
        var $parentElem = $selectionELem.parent();
        if ($selectionELem.getNodeName() === 'CODE' && $parentElem.getNodeName() === 'PRE') {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    menu - emoticon
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Emoticon(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu">\n            <i class="w-e-icon-happy"></i>\n        </div>');
    this.type = 'panel';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Emoticon.prototype = {
    constructor: Emoticon,

    onClick: function onClick() {
        this._createPanel();
    },

    _createPanel: function _createPanel() {
        var _this = this;

        var editor = this.editor;
        var config = editor.config;
        // Ëé∑ÂèñË°®ÊÉÖÈÖçÁΩÆ
        var emotions = config.emotions || [];

        // ÂàõÂª∫Ë°®ÊÉÖ dropPanel ÁöÑÈÖçÁΩÆ
        var tabConfig = [];
        emotions.forEach(function (emotData) {
            var emotType = emotData.type;
            var content = emotData.content || [];

            // Ëøô‰∏ÄÁªÑË°®ÊÉÖÊúÄÁªàÊãºÊé•Âá∫Êù•ÁöÑ html
            var faceHtml = '';

            // emoji Ë°®ÊÉÖ
            if (emotType === 'emoji') {
                content.forEach(function (item) {
                    if (item) {
                        faceHtml += '<span class="w-e-item">' + item + '</span>';
                    }
                });
            }
            // ÂõæÁâáË°®ÊÉÖ
            if (emotType === 'image') {
                content.forEach(function (item) {
                    var src = item.src;
                    var alt = item.alt;
                    if (src) {
                        // Âä†‰∏Ä‰∏™ data-w-e Â±ûÊÄßÔºåÁÇπÂáªÂõæÁâáÁöÑÊó∂ÂÄô‰∏çÂÜçÊèêÁ§∫ÁºñËæëÂõæÁâá
                        faceHtml += '<span class="w-e-item"><img src="' + src + '" alt="' + alt + '" data-w-e="1"/></span>';
                    }
                });
            }

            tabConfig.push({
                title: emotData.title,
                tpl: '<div class="w-e-emoticon-container">' + faceHtml + '</div>',
                events: [{
                    selector: 'span.w-e-item',
                    type: 'click',
                    fn: function fn(e) {
                        var target = e.target;
                        var $target = $(target);
                        var nodeName = $target.getNodeName();

                        var insertHtml = void 0;
                        if (nodeName === 'IMG') {
                            // ÊèíÂÖ•ÂõæÁâá
                            insertHtml = $target.parent().html();
                        } else {
                            // ÊèíÂÖ• emoji
                            insertHtml = '<span>' + $target.html() + '</span>';
                        }

                        _this._insert(insertHtml);
                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }]
            });
        });

        var panel = new Panel(this, {
            width: 300,
            height: 200,
            // ‰∏Ä‰∏™ Panel ÂåÖÂê´Â§ö‰∏™ tab
            tabs: tabConfig
        });

        // ÊòæÁ§∫ panel
        panel.show();

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.panel = panel;
    },

    // ÊèíÂÖ•Ë°®ÊÉÖ
    _insert: function _insert(emotHtml) {
        var editor = this.editor;
        editor.cmd.do('insertHTML', emotHtml);
    }
};

/*
    menu - table
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Table(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-table2"></i></div>');
    this.type = 'panel';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Table.prototype = {
    constructor: Table,

    onClick: function onClick() {
        if (this._active) {
            // ÁºñËæëÁé∞ÊúâË°®Ê†º
            this._createEditPanel();
        } else {
            // ÊèíÂÖ•Êñ∞Ë°®Ê†º
            this._createInsertPanel();
        }
    },

    // ÂàõÂª∫ÊèíÂÖ•Êñ∞Ë°®Ê†ºÁöÑ panel
    _createInsertPanel: function _createInsertPanel() {
        var _this = this;

        // Áî®Âà∞ÁöÑ id
        var btnInsertId = getRandom('btn');
        var textRowNum = getRandom('row');
        var textColNum = getRandom('col');

        var panel = new Panel(this, {
            width: 250,
            // panel ÂåÖÂê´Â§ö‰∏™ tab
            tabs: [{
                // Ê†áÈ¢ò
                title: 'ÊèíÂÖ•Ë°®Ê†º',
                // Ê®°Êùø
                tpl: '<div>\n                        <p style="text-align:left; padding:5px 0;">\n                            \u521B\u5EFA\n                            <input id="' + textRowNum + '" type="text" value="5" style="width:40px;text-align:center;"/>\n                            \u884C\n                            <input id="' + textColNum + '" type="text" value="5" style="width:40px;text-align:center;"/>\n                            \u5217\u7684\u8868\u683C\n                        </p>\n                        <div class="w-e-button-container">\n                            <button id="' + btnInsertId + '" class="right">\u63D2\u5165</button>\n                        </div>\n                    </div>',
                // ‰∫ã‰ª∂ÁªëÂÆö
                events: [{
                    // ÁÇπÂáªÊåâÈíÆÔºåÊèíÂÖ•Ë°®Ê†º
                    selector: '#' + btnInsertId,
                    type: 'click',
                    fn: function fn() {
                        var rowNum = parseInt($('#' + textRowNum).val());
                        var colNum = parseInt($('#' + textColNum).val());

                        if (rowNum && colNum && rowNum > 0 && colNum > 0) {
                            // form Êï∞ÊçÆÊúâÊïà
                            _this._insert(rowNum, colNum);
                        }

                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }]
            } // first tab end
            ] // tabs end
        }); // panel end

        // Â±ïÁ§∫ panel
        panel.show();

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.panel = panel;
    },

    // ÊèíÂÖ•Ë°®Ê†º
    _insert: function _insert(rowNum, colNum) {
        // ÊãºÊé• table Ê®°Êùø
        var r = void 0,
            c = void 0;
        var html = '<table border="0" width="100%" cellpadding="0" cellspacing="0">';
        for (r = 0; r < rowNum; r++) {
            html += '<tr>';
            if (r === 0) {
                for (c = 0; c < colNum; c++) {
                    html += '<th>&nbsp;</th>';
                }
            } else {
                for (c = 0; c < colNum; c++) {
                    html += '<td>&nbsp;</td>';
                }
            }
            html += '</tr>';
        }
        html += '</table><p><br></p>';

        // ÊâßË°åÂëΩ‰ª§
        var editor = this.editor;
        editor.cmd.do('insertHTML', html);

        // Èò≤Ê≠¢ firefox ‰∏ãÂá∫Áé∞ resize ÁöÑÊéßÂà∂ÁÇπ
        editor.cmd.do('enableObjectResizing', false);
        editor.cmd.do('enableInlineTableEditing', false);
    },

    // ÂàõÂª∫ÁºñËæëË°®Ê†ºÁöÑ panel
    _createEditPanel: function _createEditPanel() {
        var _this2 = this;

        // ÂèØÁî®ÁöÑ id
        var addRowBtnId = getRandom('add-row');
        var addColBtnId = getRandom('add-col');
        var delRowBtnId = getRandom('del-row');
        var delColBtnId = getRandom('del-col');
        var delTableBtnId = getRandom('del-table');

        // ÂàõÂª∫ panel ÂØπË±°
        var panel = new Panel(this, {
            width: 320,
            // panel ÂåÖÂê´Â§ö‰∏™ tab
            tabs: [{
                // Ê†áÈ¢ò
                title: 'ÁºñËæëË°®Ê†º',
                // Ê®°Êùø
                tpl: '<div>\n                        <div class="w-e-button-container" style="border-bottom:1px solid #f1f1f1;padding-bottom:5px;margin-bottom:5px;">\n                            <button id="' + addRowBtnId + '" class="left">\u589E\u52A0\u884C</button>\n                            <button id="' + delRowBtnId + '" class="red left">\u5220\u9664\u884C</button>\n                            <button id="' + addColBtnId + '" class="left">\u589E\u52A0\u5217</button>\n                            <button id="' + delColBtnId + '" class="red left">\u5220\u9664\u5217</button>\n                        </div>\n                        <div class="w-e-button-container">\n                            <button id="' + delTableBtnId + '" class="gray left">\u5220\u9664\u8868\u683C</button>\n                        </dv>\n                    </div>',
                // ‰∫ã‰ª∂ÁªëÂÆö
                events: [{
                    // Â¢ûÂä†Ë°å
                    selector: '#' + addRowBtnId,
                    type: 'click',
                    fn: function fn() {
                        _this2._addRow();
                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }, {
                    // Â¢ûÂä†Âàó
                    selector: '#' + addColBtnId,
                    type: 'click',
                    fn: function fn() {
                        _this2._addCol();
                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }, {
                    // Âà†Èô§Ë°å
                    selector: '#' + delRowBtnId,
                    type: 'click',
                    fn: function fn() {
                        _this2._delRow();
                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }, {
                    // Âà†Èô§Âàó
                    selector: '#' + delColBtnId,
                    type: 'click',
                    fn: function fn() {
                        _this2._delCol();
                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }, {
                    // Âà†Èô§Ë°®Ê†º
                    selector: '#' + delTableBtnId,
                    type: 'click',
                    fn: function fn() {
                        _this2._delTable();
                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }]
            }]
        });
        // ÊòæÁ§∫ panel
        panel.show();
    },

    // Ëé∑ÂèñÈÄâ‰∏≠ÁöÑÂçïÂÖÉÊ†ºÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ
    _getLocationData: function _getLocationData() {
        var result = {};
        var editor = this.editor;
        var $selectionELem = editor.selection.getSelectionContainerElem();
        if (!$selectionELem) {
            return;
        }
        var nodeName = $selectionELem.getNodeName();
        if (nodeName !== 'TD' && nodeName !== 'TH') {
            return;
        }

        // Ëé∑Âèñ td index
        var $tr = $selectionELem.parent();
        var $tds = $tr.children();
        var tdLength = $tds.length;
        $tds.forEach(function (td, index) {
            if (td === $selectionELem[0]) {
                // ËÆ∞ÂΩïÂπ∂Ë∑≥Âá∫Âæ™ÁéØ
                result.td = {
                    index: index,
                    elem: td,
                    length: tdLength
                };
                return false;
            }
        });

        // Ëé∑Âèñ tr index
        var $tbody = $tr.parent();
        var $trs = $tbody.children();
        var trLength = $trs.length;
        $trs.forEach(function (tr, index) {
            if (tr === $tr[0]) {
                // ËÆ∞ÂΩïÂπ∂Ë∑≥Âá∫Âæ™ÁéØ
                result.tr = {
                    index: index,
                    elem: tr,
                    length: trLength
                };
                return false;
            }
        });

        // ËøîÂõûÁªìÊûú
        return result;
    },

    // Â¢ûÂä†Ë°å
    _addRow: function _addRow() {
        // Ëé∑ÂèñÂΩìÂâçÂçïÂÖÉÊ†ºÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ
        var locationData = this._getLocationData();
        if (!locationData) {
            return;
        }
        var trData = locationData.tr;
        var $currentTr = $(trData.elem);
        var tdData = locationData.td;
        var tdLength = tdData.length;

        // ÊãºÊé•Âç≥Â∞ÜÊèíÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤
        var newTr = document.createElement('tr');
        var tpl = '',
            i = void 0;
        for (i = 0; i < tdLength; i++) {
            tpl += '<td>&nbsp;</td>';
        }
        newTr.innerHTML = tpl;
        // ÊèíÂÖ•
        $(newTr).insertAfter($currentTr);
    },

    // Â¢ûÂä†Âàó
    _addCol: function _addCol() {
        // Ëé∑ÂèñÂΩìÂâçÂçïÂÖÉÊ†ºÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ
        var locationData = this._getLocationData();
        if (!locationData) {
            return;
        }
        var trData = locationData.tr;
        var tdData = locationData.td;
        var tdIndex = tdData.index;
        var $currentTr = $(trData.elem);
        var $trParent = $currentTr.parent();
        var $trs = $trParent.children();

        // ÈÅçÂéÜÊâÄÊúâË°å
        $trs.forEach(function (tr) {
            var $tr = $(tr);
            var $tds = $tr.children();
            var $currentTd = $tds.get(tdIndex);
            var name = $currentTd.getNodeName().toLowerCase();

            // new ‰∏Ä‰∏™ tdÔºåÂπ∂ÊèíÂÖ•
            var newTd = document.createElement(name);
            $(newTd).insertAfter($currentTd);
        });
    },

    // Âà†Èô§Ë°å
    _delRow: function _delRow() {
        // Ëé∑ÂèñÂΩìÂâçÂçïÂÖÉÊ†ºÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ
        var locationData = this._getLocationData();
        if (!locationData) {
            return;
        }
        var trData = locationData.tr;
        var $currentTr = $(trData.elem);
        $currentTr.remove();
    },

    // Âà†Èô§Âàó
    _delCol: function _delCol() {
        // Ëé∑ÂèñÂΩìÂâçÂçïÂÖÉÊ†ºÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ
        var locationData = this._getLocationData();
        if (!locationData) {
            return;
        }
        var trData = locationData.tr;
        var tdData = locationData.td;
        var tdIndex = tdData.index;
        var $currentTr = $(trData.elem);
        var $trParent = $currentTr.parent();
        var $trs = $trParent.children();

        // ÈÅçÂéÜÊâÄÊúâË°å
        $trs.forEach(function (tr) {
            var $tr = $(tr);
            var $tds = $tr.children();
            var $currentTd = $tds.get(tdIndex);
            // Âà†Èô§
            $currentTd.remove();
        });
    },

    // Âà†Èô§Ë°®Ê†º
    _delTable: function _delTable() {
        var editor = this.editor;
        var $selectionELem = editor.selection.getSelectionContainerElem();
        if (!$selectionELem) {
            return;
        }
        var $table = $selectionELem.parentUntil('table');
        if (!$table) {
            return;
        }
        $table.remove();
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        var $selectionELem = editor.selection.getSelectionContainerElem();
        if (!$selectionELem) {
            return;
        }
        var nodeName = $selectionELem.getNodeName();
        if (nodeName === 'TD' || nodeName === 'TH') {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    menu - video
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Video(editor) {
    this.editor = editor;
    this.$elem = $('<div class="w-e-menu"><i class="w-e-icon-play"></i></div>');
    this.type = 'panel';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Video.prototype = {
    constructor: Video,

    onClick: function onClick() {
        this._createPanel();
    },

    _createPanel: function _createPanel() {
        var _this = this;

        // ÂàõÂª∫ id
        var textValId = getRandom('text-val');
        var btnId = getRandom('btn');

        // ÂàõÂª∫ panel
        var panel = new Panel(this, {
            width: 350,
            // ‰∏Ä‰∏™ panel Â§ö‰∏™ tab
            tabs: [{
                // Ê†áÈ¢ò
                title: 'ÊèíÂÖ•ËßÜÈ¢ë',
                // Ê®°Êùø
                tpl: '<div>\n                        <input id="' + textValId + '" type="text" class="block" placeholder="\u683C\u5F0F\u5982\uFF1A<iframe src=... ></iframe>"/>\n                        <div class="w-e-button-container">\n                            <button id="' + btnId + '" class="right">\u63D2\u5165</button>\n                        </div>\n                    </div>',
                // ‰∫ã‰ª∂ÁªëÂÆö
                events: [{
                    selector: '#' + btnId,
                    type: 'click',
                    fn: function fn() {
                        var $text = $('#' + textValId);
                        var val = $text.val().trim();

                        // ÊµãËØïÁî®ËßÜÈ¢ëÂú∞ÂùÄ
                        // <iframe height=498 width=510 src='http://player.youku.com/embed/XMjcwMzc3MzM3Mg==' frameborder=0 'allowfullscreen'></iframe>

                        if (val) {
                            // ÊèíÂÖ•ËßÜÈ¢ë
                            _this._insert(val);
                        }

                        // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                        return true;
                    }
                }]
            } // first tab end
            ] // tabs end
        }); // panel end

        // ÊòæÁ§∫ panel
        panel.show();

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.panel = panel;
    },

    // ÊèíÂÖ•ËßÜÈ¢ë
    _insert: function _insert(val) {
        var editor = this.editor;
        editor.cmd.do('insertHTML', val + '<p><br></p>');
    }
};

/*
    menu - img
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Image(editor) {
    this.editor = editor;
    var imgMenuId = getRandom('w-e-img');
    this.$elem = $('<div class="w-e-menu" id="' + imgMenuId + '"><i class="w-e-icon-image"></i></div>');
    editor.imgMenuId = imgMenuId;
    this.type = 'panel';

    // ÂΩìÂâçÊòØÂê¶ active Áä∂ÊÄÅ
    this._active = false;
}

// ÂéüÂûã
Image.prototype = {
    constructor: Image,

    onClick: function onClick() {
        var editor = this.editor;
        var config = editor.config;
        if (config.qiniu) {
            return;
        }
        if (this._active) {
            this._createEditPanel();
        } else {
            this._createInsertPanel();
        }
    },

    _createEditPanel: function _createEditPanel() {
        var editor = this.editor;

        // id
        var width30 = getRandom('width-30');
        var width50 = getRandom('width-50');
        var width100 = getRandom('width-100');
        var delBtn = getRandom('del-btn');

        // tab ÈÖçÁΩÆ
        var tabsConfig = [{
            title: 'ÁºñËæëÂõæÁâá',
            tpl: '<div>\n                    <div class="w-e-button-container" style="border-bottom:1px solid #f1f1f1;padding-bottom:5px;margin-bottom:5px;">\n                        <span style="float:left;font-size:14px;margin:4px 5px 0 5px;color:#333;">\u6700\u5927\u5BBD\u5EA6\uFF1A</span>\n                        <button id="' + width30 + '" class="left">30%</button>\n                        <button id="' + width50 + '" class="left">50%</button>\n                        <button id="' + width100 + '" class="left">100%</button>\n                    </div>\n                    <div class="w-e-button-container">\n                        <button id="' + delBtn + '" class="gray left">\u5220\u9664\u56FE\u7247</button>\n                    </dv>\n                </div>',
            events: [{
                selector: '#' + width30,
                type: 'click',
                fn: function fn() {
                    var $img = editor._selectedImg;
                    if ($img) {
                        $img.css('max-width', '30%');
                    }
                    // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                    return true;
                }
            }, {
                selector: '#' + width50,
                type: 'click',
                fn: function fn() {
                    var $img = editor._selectedImg;
                    if ($img) {
                        $img.css('max-width', '50%');
                    }
                    // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                    return true;
                }
            }, {
                selector: '#' + width100,
                type: 'click',
                fn: function fn() {
                    var $img = editor._selectedImg;
                    if ($img) {
                        $img.css('max-width', '100%');
                    }
                    // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                    return true;
                }
            }, {
                selector: '#' + delBtn,
                type: 'click',
                fn: function fn() {
                    var $img = editor._selectedImg;
                    if ($img) {
                        $img.remove();
                    }
                    // ËøîÂõû trueÔºåË°®Á§∫ËØ•‰∫ã‰ª∂ÊâßË°åÂÆå‰πãÂêéÔºåpanel Ë¶ÅÂÖ≥Èó≠„ÄÇÂê¶Âàô panel ‰∏ç‰ºöÂÖ≥Èó≠
                    return true;
                }
            }]
        }];

        // ÂàõÂª∫ panel Âπ∂ÊòæÁ§∫
        var panel = new Panel(this, {
            width: 300,
            tabs: tabsConfig
        });
        panel.show();

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.panel = panel;
    },

    _createInsertPanel: function _createInsertPanel() {
        var editor = this.editor;
        var uploadImg = editor.uploadImg;
        var config = editor.config;

        // id
        var upTriggerId = getRandom('up-trigger');
        var upFileId = getRandom('up-file');
        var linkUrlId = getRandom('link-url');
        var linkBtnId = getRandom('link-btn');

        // tabs ÁöÑÈÖçÁΩÆ
        var tabsConfig = [{
            title: '‰∏ä‰º†ÂõæÁâá',
            tpl: '<div class="w-e-up-img-container">\n                    <div id="' + upTriggerId + '" class="w-e-up-btn">\n                        <i class="w-e-icon-upload2"></i>\n                    </div>\n                    <div style="display:none;">\n                        <input id="' + upFileId + '" type="file" multiple="multiple" accept="image/jpg,image/jpeg,image/png,image/gif,image/bmp"/>\n                    </div>\n                </div>',
            events: [{
                // Ëß¶ÂèëÈÄâÊã©ÂõæÁâá
                selector: '#' + upTriggerId,
                type: 'click',
                fn: function fn() {
                    var $file = $('#' + upFileId);
                    var fileElem = $file[0];
                    if (fileElem) {
                        fileElem.click();
                    } else {
                        // ËøîÂõû true ÂèØÂÖ≥Èó≠ panel
                        return true;
                    }
                }
            }, {
                // ÈÄâÊã©ÂõæÁâáÂÆåÊØï
                selector: '#' + upFileId,
                type: 'change',
                fn: function fn() {
                    var $file = $('#' + upFileId);
                    var fileElem = $file[0];
                    if (!fileElem) {
                        // ËøîÂõû true ÂèØÂÖ≥Èó≠ panel
                        return true;
                    }

                    // Ëé∑ÂèñÈÄâ‰∏≠ÁöÑ file ÂØπË±°ÂàóË°®
                    var fileList = fileElem.files;
                    if (fileList.length) {
                        uploadImg.uploadImg(fileList);
                    }

                    // ËøîÂõû true ÂèØÂÖ≥Èó≠ panel
                    return true;
                }
            }]
        }, // first tab end
        {
            title: 'ÁΩëÁªúÂõæÁâá',
            tpl: '<div>\n                    <input id="' + linkUrlId + '" type="text" class="block" placeholder="\u56FE\u7247\u94FE\u63A5"/></td>\n                    <div class="w-e-button-container">\n                        <button id="' + linkBtnId + '" class="right">\u63D2\u5165</button>\n                    </div>\n                </div>',
            events: [{
                selector: '#' + linkBtnId,
                type: 'click',
                fn: function fn() {
                    var $linkUrl = $('#' + linkUrlId);
                    var url = $linkUrl.val().trim();

                    if (url) {
                        uploadImg.insertLinkImg(url);
                    }

                    // ËøîÂõû true Ë°®Á§∫ÂáΩÊï∞ÊâßË°åÁªìÊùü‰πãÂêéÂÖ≥Èó≠ panel
                    return true;
                }
            }]
        } // second tab end
        ]; // tabs end

        // Âà§Êñ≠ tabs ÁöÑÊòæÁ§∫
        var tabsConfigResult = [];
        if ((config.uploadImgShowBase64 || config.uploadImgServer || config.customUploadImg) && window.FileReader) {
            // ÊòæÁ§∫‚Äú‰∏ä‰º†ÂõæÁâá‚Äù
            tabsConfigResult.push(tabsConfig[0]);
        }
        if (config.showLinkImg) {
            // ÊòæÁ§∫‚ÄúÁΩëÁªúÂõæÁâá‚Äù
            tabsConfigResult.push(tabsConfig[1]);
        }

        // ÂàõÂª∫ panel Âπ∂ÊòæÁ§∫
        var panel = new Panel(this, {
            width: 300,
            tabs: tabsConfigResult
        });
        panel.show();

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.panel = panel;
    },

    // ËØïÂõæÊîπÂèò active Áä∂ÊÄÅ
    tryChangeActive: function tryChangeActive(e) {
        var editor = this.editor;
        var $elem = this.$elem;
        if (editor._selectedImg) {
            this._active = true;
            $elem.addClass('w-e-active');
        } else {
            this._active = false;
            $elem.removeClass('w-e-active');
        }
    }
};

/*
    ÊâÄÊúâËèúÂçïÁöÑÊ±áÊÄª
*/

// Â≠òÂÇ®ËèúÂçïÁöÑÊûÑÈÄ†ÂáΩÊï∞
var MenuConstructors = {};

MenuConstructors.bold = Bold;

MenuConstructors.head = Head;

MenuConstructors.fontSize = FontSize;

MenuConstructors.fontName = FontName;

MenuConstructors.link = Link;

MenuConstructors.italic = Italic;

MenuConstructors.redo = Redo;

MenuConstructors.strikeThrough = StrikeThrough;

MenuConstructors.underline = Underline;

MenuConstructors.undo = Undo;

MenuConstructors.list = List;

MenuConstructors.justify = Justify;

MenuConstructors.foreColor = ForeColor;

MenuConstructors.backColor = BackColor;

MenuConstructors.quote = Quote;

MenuConstructors.code = Code;

MenuConstructors.emoticon = Emoticon;

MenuConstructors.table = Table;

MenuConstructors.video = Video;

MenuConstructors.image = Image;

/*
    ËèúÂçïÈõÜÂêà
*/
// ÊûÑÈÄ†ÂáΩÊï∞
function Menus(editor) {
    this.editor = editor;
    this.menus = {};
}

// ‰øÆÊîπÂéüÂûã
Menus.prototype = {
    constructor: Menus,

    // ÂàùÂßãÂåñËèúÂçï
    init: function init() {
        var _this = this;

        var editor = this.editor;
        var config = editor.config || {};
        var configMenus = config.menus || []; // Ëé∑ÂèñÈÖçÁΩÆ‰∏≠ÁöÑËèúÂçï

        // Ê†πÊçÆÈÖçÁΩÆ‰ø°ÊÅØÔºåÂàõÂª∫ËèúÂçï
        configMenus.forEach(function (menuKey) {
            var MenuConstructor = MenuConstructors[menuKey];
            if (MenuConstructor && typeof MenuConstructor === 'function') {
                // ÂàõÂª∫Âçï‰∏™ËèúÂçï
                _this.menus[menuKey] = new MenuConstructor(editor);
            }
        });

        // Ê∑ªÂä†Âà∞ËèúÂçïÊ†è
        this._addToToolbar();

        // ÁªëÂÆö‰∫ã‰ª∂
        this._bindEvent();
    },

    // Ê∑ªÂä†Âà∞ËèúÂçïÊ†è
    _addToToolbar: function _addToToolbar() {
        var editor = this.editor;
        var $toolbarElem = editor.$toolbarElem;
        var menus = this.menus;
        var config = editor.config;
        // config.zIndex ÊòØÈÖçÁΩÆÁöÑÁºñËæëÂå∫ÂüüÁöÑ z-indexÔºåËèúÂçïÁöÑ z-index ÂæóÂú®ÂÖ∂Âü∫Á°Ä‰∏ä +1
        var zIndex = config.zIndex + 1;
        objForEach(menus, function (key, menu) {
            var $elem = menu.$elem;
            if ($elem) {
                // ËÆæÁΩÆ z-index
                $elem.css('z-index', zIndex);
                $toolbarElem.append($elem);
            }
        });
    },

    // ÁªëÂÆöËèúÂçï click mouseenter ‰∫ã‰ª∂
    _bindEvent: function _bindEvent() {
        var menus = this.menus;
        var editor = this.editor;
        objForEach(menus, function (key, menu) {
            var type = menu.type;
            if (!type) {
                return;
            }
            var $elem = menu.$elem;
            var droplist = menu.droplist;
            var panel = menu.panel;

            // ÁÇπÂáªÁ±ªÂûãÔºå‰æãÂ¶Ç bold
            if (type === 'click' && menu.onClick) {
                $elem.on('click', function (e) {
                    if (editor.selection.getRange() == null) {
                        return;
                    }
                    menu.onClick(e);
                });
            }

            // ‰∏ãÊãâÊ°ÜÔºå‰æãÂ¶Ç head
            if (type === 'droplist' && droplist) {
                $elem.on('mouseenter', function (e) {
                    if (editor.selection.getRange() == null) {
                        return;
                    }
                    // ÊòæÁ§∫
                    droplist.showTimeoutId = setTimeout(function () {
                        droplist.show();
                    }, 200);
                }).on('mouseleave', function (e) {
                    // ÈöêËóè
                    droplist.hideTimeoutId = setTimeout(function () {
                        droplist.hide();
                    }, 0);
                });
            }

            // ÂºπÊ°ÜÁ±ªÂûãÔºå‰æãÂ¶Ç link
            if (type === 'panel' && menu.onClick) {
                $elem.on('click', function (e) {
                    e.stopPropagation();
                    if (editor.selection.getRange() == null) {
                        return;
                    }
                    // Âú®Ëá™ÂÆö‰πâ‰∫ã‰ª∂‰∏≠ÊòæÁ§∫ panel
                    menu.onClick(e);
                });
            }
        });
    },

    // Â∞ùËØï‰øÆÊîπËèúÂçïÁä∂ÊÄÅ
    changeActive: function changeActive() {
        var menus = this.menus;
        objForEach(menus, function (key, menu) {
            if (menu.tryChangeActive) {
                setTimeout(function () {
                    menu.tryChangeActive();
                }, 100);
            }
        });
    }
};

/*
    Á≤òË¥¥‰ø°ÊÅØÁöÑÂ§ÑÁêÜ
*/

// Ëé∑ÂèñÁ≤òË¥¥ÁöÑÁ∫ØÊñáÊú¨
function getPasteText(e) {
    var clipboardData = e.clipboardData || e.originalEvent && e.originalEvent.clipboardData;
    var pasteText = void 0;
    if (clipboardData == null) {
        pasteText = window.clipboardData && window.clipboardData.getData('text');
    } else {
        pasteText = clipboardData.getData('text/plain');
    }

    return replaceHtmlSymbol(pasteText);
}

// Ëé∑ÂèñÁ≤òË¥¥ÁöÑhtml
function getPasteHtml(e, filterStyle, ignoreImg) {
    var clipboardData = e.clipboardData || e.originalEvent && e.originalEvent.clipboardData;
    var pasteText = void 0,
        pasteHtml = void 0;
    if (clipboardData == null) {
        pasteText = window.clipboardData && window.clipboardData.getData('text');
    } else {
        pasteText = clipboardData.getData('text/plain');
        pasteHtml = clipboardData.getData('text/html');
    }
    if (!pasteHtml && pasteText) {
        pasteHtml = '<p>' + replaceHtmlSymbol(pasteText) + '</p>';
    }
    if (!pasteHtml) {
        return;
    }

    // ËøáÊª§word‰∏≠Áä∂ÊÄÅËøáÊù•ÁöÑÊó†Áî®Â≠óÁ¨¶
    var docSplitHtml = pasteHtml.split('</html>');
    if (docSplitHtml.length === 2) {
        pasteHtml = docSplitHtml[0];
    }

    // ËøáÊª§Êó†Áî®Ê†áÁ≠æ
    pasteHtml = pasteHtml.replace(/<(meta|script|link).+?>/igm, '');
    // ÂéªÊéâÊ≥®Èáä
    pasteHtml = pasteHtml.replace(/<!--.*?-->/mg, '');
    // ËøáÊª§ data-xxx Â±ûÊÄß
    pasteHtml = pasteHtml.replace(/\s?data-.+?=('|").+?('|")/igm, '');

    if (ignoreImg) {
        // ÂøΩÁï•ÂõæÁâá
        pasteHtml = pasteHtml.replace(/<img.+?>/igm, '');
    }

    if (filterStyle) {
        // ËøáÊª§Ê†∑Âºè
        pasteHtml = pasteHtml.replace(/\s?(class|style)=('|").*?('|")/igm, '');
    } else {
        // ‰øùÁïôÊ†∑Âºè
        pasteHtml = pasteHtml.replace(/\s?class=('|").*?('|")/igm, '');
    }

    return pasteHtml;
}

// Ëé∑ÂèñÁ≤òË¥¥ÁöÑÂõæÁâáÊñá‰ª∂
function getPasteImgs(e) {
    var result = [];
    var txt = getPasteText(e);
    if (txt) {
        // ÊúâÊñáÂ≠óÔºåÂ∞±ÂøΩÁï•ÂõæÁâá
        return result;
    }

    var clipboardData = e.clipboardData || e.originalEvent && e.originalEvent.clipboardData || {};
    var items = clipboardData.items;
    if (!items) {
        return result;
    }

    objForEach(items, function (key, value) {
        var type = value.type;
        if (/image/i.test(type)) {
            result.push(value.getAsFile());
        }
    });

    return result;
}

/*
    ÁºñËæëÂå∫Âüü
*/

// Ëé∑Âèñ‰∏Ä‰∏™ elem.childNodes ÁöÑ JSON Êï∞ÊçÆ
function getChildrenJSON($elem) {
    var result = [];
    var $children = $elem.childNodes() || []; // Ê≥®ÊÑè childNodes() ÂèØ‰ª•Ëé∑ÂèñÊñáÊú¨ËäÇÁÇπ
    $children.forEach(function (curElem) {
        var elemResult = void 0;
        var nodeType = curElem.nodeType;

        // ÊñáÊú¨ËäÇÁÇπ
        if (nodeType === 3) {
            elemResult = curElem.textContent;
            elemResult = replaceHtmlSymbol(elemResult);
        }

        // ÊôÆÈÄö DOM ËäÇÁÇπ
        if (nodeType === 1) {
            elemResult = {};

            // tag
            elemResult.tag = curElem.nodeName.toLowerCase();
            // attr
            var attrData = [];
            var attrList = curElem.attributes || {};
            var attrListLength = attrList.length || 0;
            for (var i = 0; i < attrListLength; i++) {
                var attr = attrList[i];
                attrData.push({
                    name: attr.name,
                    value: attr.value
                });
            }
            elemResult.attrs = attrData;
            // childrenÔºàÈÄíÂΩíÔºâ
            elemResult.children = getChildrenJSON($(curElem));
        }

        result.push(elemResult);
    });
    return result;
}

// ÊûÑÈÄ†ÂáΩÊï∞
function Text(editor) {
    this.editor = editor;
}

// ‰øÆÊîπÂéüÂûã
Text.prototype = {
    constructor: Text,

    // ÂàùÂßãÂåñ
    init: function init() {
        // ÁªëÂÆö‰∫ã‰ª∂
        this._bindEvent();
    },

    // Ê∏ÖÁ©∫ÂÜÖÂÆπ
    clear: function clear() {
        this.html('<p><br></p>');
    },

    // Ëé∑Âèñ ËÆæÁΩÆ html
    html: function html(val) {
        var editor = this.editor;
        var $textElem = editor.$textElem;
        var html = void 0;
        if (val == null) {
            html = $textElem.html();
            // Êú™ÈÄâ‰∏≠‰ªª‰ΩïÂÜÖÂÆπÁöÑÊó∂ÂÄôÁÇπÂáª‚ÄúÂä†Á≤ó‚ÄùÊàñËÄÖ‚ÄúÊñú‰Ωì‚ÄùÁ≠âÊåâÈíÆÔºåÂ∞±ÂæóÈúÄË¶Å‰∏Ä‰∏™Á©∫ÁöÑÂç†‰ΩçÁ¨¶ &#8203 ÔºåËøôÈáåÊõøÊç¢Êéâ
            html = html.replace(/\u200b/gm, '');
            return html;
        } else {
            $textElem.html(val);

            // ÂàùÂßãÂåñÈÄâÂèñÔºåÂ∞ÜÂÖâÊ†áÂÆö‰ΩçÂà∞ÂÜÖÂÆπÂ∞æÈÉ®
            editor.initSelection();
        }
    },

    // Ëé∑Âèñ JSON
    getJSON: function getJSON() {
        var editor = this.editor;
        var $textElem = editor.$textElem;
        return getChildrenJSON($textElem);
    },

    // Ëé∑Âèñ ËÆæÁΩÆ text
    text: function text(val) {
        var editor = this.editor;
        var $textElem = editor.$textElem;
        var text = void 0;
        if (val == null) {
            text = $textElem.text();
            // Êú™ÈÄâ‰∏≠‰ªª‰ΩïÂÜÖÂÆπÁöÑÊó∂ÂÄôÁÇπÂáª‚ÄúÂä†Á≤ó‚ÄùÊàñËÄÖ‚ÄúÊñú‰Ωì‚ÄùÁ≠âÊåâÈíÆÔºåÂ∞±ÂæóÈúÄË¶Å‰∏Ä‰∏™Á©∫ÁöÑÂç†‰ΩçÁ¨¶ &#8203 ÔºåËøôÈáåÊõøÊç¢Êéâ
            text = text.replace(/\u200b/gm, '');
            return text;
        } else {
            $textElem.text('<p>' + val + '</p>');

            // ÂàùÂßãÂåñÈÄâÂèñÔºåÂ∞ÜÂÖâÊ†áÂÆö‰ΩçÂà∞ÂÜÖÂÆπÂ∞æÈÉ®
            editor.initSelection();
        }
    },

    // ËøΩÂä†ÂÜÖÂÆπ
    append: function append(html) {
        var editor = this.editor;
        var $textElem = editor.$textElem;
        $textElem.append($(html));

        // ÂàùÂßãÂåñÈÄâÂèñÔºåÂ∞ÜÂÖâÊ†áÂÆö‰ΩçÂà∞ÂÜÖÂÆπÂ∞æÈÉ®
        editor.initSelection();
    },

    // ÁªëÂÆö‰∫ã‰ª∂
    _bindEvent: function _bindEvent() {
        // ÂÆûÊó∂‰øùÂ≠òÈÄâÂèñ
        this._saveRangeRealTime();

        // ÊåâÂõûËΩ¶Âª∫Êó∂ÁöÑÁâπÊÆäÂ§ÑÁêÜ
        this._enterKeyHandle();

        // Ê∏ÖÁ©∫Êó∂‰øùÁïô <p><br></p>
        this._clearHandle();

        // Á≤òË¥¥‰∫ã‰ª∂ÔºàÁ≤òË¥¥ÊñáÂ≠óÔºåÁ≤òË¥¥ÂõæÁâáÔºâ
        this._pasteHandle();

        // tab ÁâπÊÆäÂ§ÑÁêÜ
        this._tabHandle();

        // img ÁÇπÂáª
        this._imgHandle();

        // ÊãñÊãΩ‰∫ã‰ª∂
        this._dragHandle();
    },

    // ÂÆûÊó∂‰øùÂ≠òÈÄâÂèñ
    _saveRangeRealTime: function _saveRangeRealTime() {
        var editor = this.editor;
        var $textElem = editor.$textElem;

        // ‰øùÂ≠òÂΩìÂâçÁöÑÈÄâÂå∫
        function saveRange(e) {
            // ÈöèÊó∂‰øùÂ≠òÈÄâÂå∫
            editor.selection.saveRange();
            // Êõ¥Êñ∞ÊåâÈíÆ ative Áä∂ÊÄÅ
            editor.menus.changeActive();
        }
        // ÊåâÈîÆÂêé‰øùÂ≠ò
        $textElem.on('keyup', saveRange);
        $textElem.on('mousedown', function (e) {
            // mousedown Áä∂ÊÄÅ‰∏ãÔºåÈº†Ê†áÊªëÂä®Âà∞ÁºñËæëÂå∫ÂüüÂ§ñÈù¢Ôºå‰πüÈúÄË¶Å‰øùÂ≠òÈÄâÂå∫
            $textElem.on('mouseleave', saveRange);
        });
        $textElem.on('mouseup', function (e) {
            saveRange();
            // Âú®ÁºñËæëÂô®Âå∫Âüü‰πãÂÜÖÂÆåÊàêÁÇπÂáªÔºåÂèñÊ∂àÈº†Ê†áÊªëÂä®Âà∞ÁºñËæëÂå∫Â§ñÈù¢ÁöÑ‰∫ã‰ª∂
            $textElem.off('mouseleave', saveRange);
        });
    },

    // ÊåâÂõûËΩ¶ÈîÆÊó∂ÁöÑÁâπÊÆäÂ§ÑÁêÜ
    _enterKeyHandle: function _enterKeyHandle() {
        var editor = this.editor;
        var $textElem = editor.$textElem;

        function insertEmptyP($selectionElem) {
            var $p = $('<p><br></p>');
            $p.insertBefore($selectionElem);
            editor.selection.createRangeByElem($p, true);
            editor.selection.restoreSelection();
            $selectionElem.remove();
        }

        // Â∞ÜÂõûËΩ¶‰πãÂêéÁîüÊàêÁöÑÈùû <p> ÁöÑÈ°∂Á∫ßÊ†áÁ≠æÔºåÊîπ‰∏∫ <p>
        function pHandle(e) {
            var $selectionElem = editor.selection.getSelectionContainerElem();
            var $parentElem = $selectionElem.parent();

            if ($parentElem.html() === '<code><br></code>') {
                // ÂõûËΩ¶‰πãÂâçÂÖâÊ†áÊâÄÂú®‰∏Ä‰∏™ <p><code>.....</code></p> ÔºåÂøΩÁÑ∂ÂõûËΩ¶ÁîüÊàê‰∏Ä‰∏™Á©∫ÁöÑ <p><code><br></code></p>
                // ËÄå‰∏îÁªßÁª≠ÂõûËΩ¶Ë∑≥‰∏çÂá∫ÂéªÔºåÂõ†Ê≠§Âè™ËÉΩÁâπÊÆäÂ§ÑÁêÜ
                insertEmptyP($selectionElem);
                return;
            }

            if (!$parentElem.equal($textElem)) {
                // ‰∏çÊòØÈ°∂Á∫ßÊ†áÁ≠æ
                return;
            }

            var nodeName = $selectionElem.getNodeName();
            if (nodeName === 'P') {
                // ÂΩìÂâçÁöÑÊ†áÁ≠æÊòØ P Ôºå‰∏çÁî®ÂÅöÂ§ÑÁêÜ
                return;
            }

            if ($selectionElem.text()) {
                // ÊúâÂÜÖÂÆπÔºå‰∏çÂÅöÂ§ÑÁêÜ
                return;
            }

            // ÊèíÂÖ• <p> ÔºåÂπ∂Â∞ÜÈÄâÂèñÂÆö‰ΩçÂà∞ <p>ÔºåÂà†Èô§ÂΩìÂâçÊ†áÁ≠æ
            insertEmptyP($selectionElem);
        }

        $textElem.on('keyup', function (e) {
            if (e.keyCode !== 13) {
                // ‰∏çÊòØÂõûËΩ¶ÈîÆ
                return;
            }
            // Â∞ÜÂõûËΩ¶‰πãÂêéÁîüÊàêÁöÑÈùû <p> ÁöÑÈ°∂Á∫ßÊ†áÁ≠æÔºåÊîπ‰∏∫ <p>
            pHandle(e);
        });

        // <pre><code></code></pre> ÂõûËΩ¶Êó∂ ÁâπÊÆäÂ§ÑÁêÜ
        function codeHandle(e) {
            var $selectionElem = editor.selection.getSelectionContainerElem();
            if (!$selectionElem) {
                return;
            }
            var $parentElem = $selectionElem.parent();
            var selectionNodeName = $selectionElem.getNodeName();
            var parentNodeName = $parentElem.getNodeName();

            if (selectionNodeName !== 'CODE' || parentNodeName !== 'PRE') {
                // ‰∏çÁ¨¶ÂêàË¶ÅÊ±Ç ÂøΩÁï•
                return;
            }

            if (!editor.cmd.queryCommandSupported('insertHTML')) {
                // ÂøÖÈ°ªÂéüÁîüÊîØÊåÅ insertHTML ÂëΩ‰ª§
                return;
            }

            // Â§ÑÁêÜÔºöÂÖâÊ†áÂÆö‰ΩçÂà∞‰ª£Á†ÅÊú´Â∞æÔºåËÅîÁ≥ªÁÇπÂáª‰∏§Ê¨°ÂõûËΩ¶ÔºåÂç≥Ë∑≥Âá∫‰ª£Á†ÅÂùó
            if (editor._willBreakCode === true) {
                // Ê≠§Êó∂ÂèØ‰ª•Ë∑≥Âá∫‰ª£Á†ÅÂùó
                // ÊèíÂÖ• <p> ÔºåÂπ∂Â∞ÜÈÄâÂèñÂÆö‰ΩçÂà∞ <p>
                var $p = $('<p><br></p>');
                $p.insertAfter($parentElem);
                editor.selection.createRangeByElem($p, true);
                editor.selection.restoreSelection();

                // ‰øÆÊîπÁä∂ÊÄÅ
                editor._willBreakCode = false;

                e.preventDefault();
                return;
            }

            var _startOffset = editor.selection.getRange().startOffset;

            // Â§ÑÁêÜÔºöÂõûËΩ¶Êó∂Ôºå‰∏çËÉΩÊèíÂÖ• <br> ËÄåÊòØÊèíÂÖ• \n ÔºåÂõ†‰∏∫ÊòØÂú® pre Ê†áÁ≠æÈáåÈù¢
            editor.cmd.do('insertHTML', '\n');
            editor.selection.saveRange();
            if (editor.selection.getRange().startOffset === _startOffset) {
                // Ê≤°Ëµ∑‰ΩúÁî®ÔºåÂÜçÊù•‰∏ÄÈÅç
                editor.cmd.do('insertHTML', '\n');
            }

            var codeLength = $selectionElem.html().length;
            if (editor.selection.getRange().startOffset + 1 === codeLength) {
                // ËØ¥ÊòéÂÖâÊ†áÂú®‰ª£Á†ÅÊúÄÂêéÁöÑ‰ΩçÁΩÆÔºåÊâßË°å‰∫ÜÂõûËΩ¶Êìç‰Ωú
                // ËÆ∞ÂΩï‰∏ãÊù•Ôºå‰ª•‰æø‰∏ãÊ¨°ÂõûËΩ¶Êó∂ÂÄôË∑≥Âá∫ code
                editor._willBreakCode = true;
            }

            // ÈòªÊ≠¢ÈªòËÆ§Ë°å‰∏∫
            e.preventDefault();
        }

        $textElem.on('keydown', function (e) {
            if (e.keyCode !== 13) {
                // ‰∏çÊòØÂõûËΩ¶ÈîÆ
                // ÂèñÊ∂àÂç≥Â∞ÜË∑≥ËΩ¨‰ª£Á†ÅÂùóÁöÑËÆ∞ÂΩï
                editor._willBreakCode = false;
                return;
            }
            // <pre><code></code></pre> ÂõûËΩ¶Êó∂ ÁâπÊÆäÂ§ÑÁêÜ
            codeHandle(e);
        });
    },

    // Ê∏ÖÁ©∫Êó∂‰øùÁïô <p><br></p>
    _clearHandle: function _clearHandle() {
        var editor = this.editor;
        var $textElem = editor.$textElem;

        $textElem.on('keydown', function (e) {
            if (e.keyCode !== 8) {
                return;
            }
            var txtHtml = $textElem.html().toLowerCase().trim();
            if (txtHtml === '<p><br></p>') {
                // ÊúÄÂêéÂâ©‰∏ã‰∏Ä‰∏™Á©∫Ë°åÔºåÂ∞±‰∏çÂÜçÂà†Èô§‰∫Ü
                e.preventDefault();
                return;
            }
        });

        $textElem.on('keyup', function (e) {
            if (e.keyCode !== 8) {
                return;
            }
            var $p = void 0;
            var txtHtml = $textElem.html().toLowerCase().trim();

            // firefox Êó∂Áî® txtHtml === '<br>' Âà§Êñ≠ÔºåÂÖ∂‰ªñÁî® !txtHtml Âà§Êñ≠
            if (!txtHtml || txtHtml === '<br>') {
                // ÂÜÖÂÆπÁ©∫‰∫Ü
                $p = $('<p><br/></p>');
                $textElem.html(''); // ‰∏ÄÂÆöË¶ÅÂÖàÊ∏ÖÁ©∫ÔºåÂê¶ÂàôÂú® firefox ‰∏ãÊúâÈóÆÈ¢ò
                $textElem.append($p);
                editor.selection.createRangeByElem($p, false, true);
                editor.selection.restoreSelection();
            }
        });
    },

    // Á≤òË¥¥‰∫ã‰ª∂ÔºàÁ≤òË¥¥ÊñáÂ≠ó Á≤òË¥¥ÂõæÁâáÔºâ
    _pasteHandle: function _pasteHandle() {
        var editor = this.editor;
        var config = editor.config;
        var pasteFilterStyle = config.pasteFilterStyle;
        var pasteTextHandle = config.pasteTextHandle;
        var ignoreImg = config.pasteIgnoreImg;
        var $textElem = editor.$textElem;

        // Á≤òË¥¥ÂõæÁâá„ÄÅÊñáÊú¨ÁöÑ‰∫ã‰ª∂ÔºåÊØèÊ¨°Âè™ËÉΩÊâßË°å‰∏Ä‰∏™
        // Âà§Êñ≠ËØ•Ê¨°Á≤òË¥¥‰∫ã‰ª∂ÊòØÂê¶ÂèØ‰ª•ÊâßË°å
        var pasteTime = 0;
        function canDo() {
            var now = Date.now();
            var flag = false;
            if (now - pasteTime >= 100) {
                // Èó¥ÈöîÂ§ß‰∫é 100 ms ÔºåÂèØ‰ª•ÊâßË°å
                flag = true;
            }
            pasteTime = now;
            return flag;
        }
        function resetTime() {
            pasteTime = 0;
        }

        // Á≤òË¥¥ÊñáÂ≠ó
        $textElem.on('paste', function (e) {
            if (UA.isIE()) {
                return;
            } else {
                // ÈòªÊ≠¢ÈªòËÆ§Ë°å‰∏∫Ôºå‰ΩøÁî® execCommand ÁöÑÁ≤òË¥¥ÂëΩ‰ª§
                e.preventDefault();
            }

            // Á≤òË¥¥ÂõæÁâáÂíåÊñáÊú¨ÔºåÂè™ËÉΩÂêåÊó∂‰ΩøÁî®‰∏Ä‰∏™
            if (!canDo()) {
                return;
            }

            // Ëé∑ÂèñÁ≤òË¥¥ÁöÑÊñáÂ≠ó
            var pasteHtml = getPasteHtml(e, pasteFilterStyle, ignoreImg);
            var pasteText = getPasteText(e);
            pasteText = pasteText.replace(/\n/gm, '<br>');

            var $selectionElem = editor.selection.getSelectionContainerElem();
            if (!$selectionElem) {
                return;
            }
            var nodeName = $selectionElem.getNodeName();

            // code ‰∏≠Âè™ËÉΩÁ≤òË¥¥Á∫ØÊñáÊú¨
            if (nodeName === 'CODE' || nodeName === 'PRE') {
                if (pasteTextHandle && isFunction(pasteTextHandle)) {
                    // Áî®Êà∑Ëá™ÂÆö‰πâËøáÊª§Â§ÑÁêÜÁ≤òË¥¥ÂÜÖÂÆπ
                    pasteText = '' + (pasteTextHandle(pasteText) || '');
                }
                editor.cmd.do('insertHTML', '<p>' + pasteText + '</p>');
                return;
            }

            // ÂÖàÊîæÂºÄÊ≥®ÈáäÔºåÊúâÈóÆÈ¢òÂÜçËøΩÊü• ‚Äî‚Äî‚Äî‚Äî
            // // Ë°®Ê†º‰∏≠ÂøΩÁï•ÔºåÂèØËÉΩ‰ºöÂá∫Áé∞ÂºÇÂ∏∏ÈóÆÈ¢ò
            // if (nodeName === 'TD' || nodeName === 'TH') {
            //     return
            // }

            if (!pasteHtml) {
                // Ê≤°ÊúâÂÜÖÂÆπÔºåÂèØÁªßÁª≠ÊâßË°å‰∏ãÈù¢ÁöÑÂõæÁâáÁ≤òË¥¥
                resetTime();
                return;
            }
            try {
                // firefox ‰∏≠ÔºåËé∑ÂèñÁöÑ pasteHtml ÂèØËÉΩÊòØÊ≤°Êúâ <ul> ÂåÖË£πÁöÑ <li>
                // Âõ†Ê≠§ÊâßË°å insertHTML ‰ºöÊä•Èîô
                if (pasteTextHandle && isFunction(pasteTextHandle)) {
                    // Áî®Êà∑Ëá™ÂÆö‰πâËøáÊª§Â§ÑÁêÜÁ≤òË¥¥ÂÜÖÂÆπ
                    pasteHtml = '' + (pasteTextHandle(pasteHtml) || '');
                }
                editor.cmd.do('insertHTML', pasteHtml);
            } catch (ex) {
                // Ê≠§Êó∂‰ΩøÁî® pasteText Êù•ÂÖºÂÆπ‰∏Ä‰∏ã
                if (pasteTextHandle && isFunction(pasteTextHandle)) {
                    // Áî®Êà∑Ëá™ÂÆö‰πâËøáÊª§Â§ÑÁêÜÁ≤òË¥¥ÂÜÖÂÆπ
                    pasteText = '' + (pasteTextHandle(pasteText) || '');
                }
                editor.cmd.do('insertHTML', '<p>' + pasteText + '</p>');
            }
        });

        // Á≤òË¥¥ÂõæÁâá
        $textElem.on('paste', function (e) {
            if (UA.isIE()) {
                return;
            } else {
                e.preventDefault();
            }

            // Á≤òË¥¥ÂõæÁâáÂíåÊñáÊú¨ÔºåÂè™ËÉΩÂêåÊó∂‰ΩøÁî®‰∏Ä‰∏™
            if (!canDo()) {
                return;
            }

            // Ëé∑ÂèñÁ≤òË¥¥ÁöÑÂõæÁâá
            var pasteFiles = getPasteImgs(e);
            if (!pasteFiles || !pasteFiles.length) {
                return;
            }

            // Ëé∑ÂèñÂΩìÂâçÁöÑÂÖÉÁ¥†
            var $selectionElem = editor.selection.getSelectionContainerElem();
            if (!$selectionElem) {
                return;
            }
            var nodeName = $selectionElem.getNodeName();

            // code ‰∏≠Á≤òË¥¥ÂøΩÁï•
            if (nodeName === 'CODE' || nodeName === 'PRE') {
                return;
            }

            // ‰∏ä‰º†ÂõæÁâá
            var uploadImg = editor.uploadImg;
            uploadImg.uploadImg(pasteFiles);
        });
    },

    // tab ÁâπÊÆäÂ§ÑÁêÜ
    _tabHandle: function _tabHandle() {
        var editor = this.editor;
        var $textElem = editor.$textElem;

        $textElem.on('keydown', function (e) {
            if (e.keyCode !== 9) {
                return;
            }
            if (!editor.cmd.queryCommandSupported('insertHTML')) {
                // ÂøÖÈ°ªÂéüÁîüÊîØÊåÅ insertHTML ÂëΩ‰ª§
                return;
            }
            var $selectionElem = editor.selection.getSelectionContainerElem();
            if (!$selectionElem) {
                return;
            }
            var $parentElem = $selectionElem.parent();
            var selectionNodeName = $selectionElem.getNodeName();
            var parentNodeName = $parentElem.getNodeName();

            if (selectionNodeName === 'CODE' && parentNodeName === 'PRE') {
                // <pre><code> ÈáåÈù¢
                editor.cmd.do('insertHTML', '    ');
            } else {
                // ÊôÆÈÄöÊñáÂ≠ó
                editor.cmd.do('insertHTML', '&nbsp;&nbsp;&nbsp;&nbsp;');
            }

            e.preventDefault();
        });
    },

    // img ÁÇπÂáª
    _imgHandle: function _imgHandle() {
        var editor = this.editor;
        var $textElem = editor.$textElem;

        // ‰∏∫ÂõæÁâáÂ¢ûÂä† selected Ê†∑Âºè
        $textElem.on('click', 'img', function (e) {
            var img = this;
            var $img = $(img);

            if ($img.attr('data-w-e') === '1') {
                // ÊòØË°®ÊÉÖÂõæÁâáÔºåÂøΩÁï•
                return;
            }

            // ËÆ∞ÂΩïÂΩìÂâçÁÇπÂáªËøáÁöÑÂõæÁâá
            editor._selectedImg = $img;

            // ‰øÆÊîπÈÄâÂå∫Âπ∂ restore ÔºåÈò≤Ê≠¢Áî®Êà∑Ê≠§Êó∂ÁÇπÂáªÈÄÄÊ†ºÈîÆÔºå‰ºöÂà†Èô§ÂÖ∂‰ªñÂÜÖÂÆπ
            editor.selection.createRangeByElem($img);
            editor.selection.restoreSelection();
        });

        // ÂéªÊéâÂõæÁâáÁöÑ selected Ê†∑Âºè
        $textElem.on('click  keyup', function (e) {
            if (e.target.matches('img')) {
                // ÁÇπÂáªÁöÑÊòØÂõæÁâáÔºåÂøΩÁï•
                return;
            }
            // Âà†Èô§ËÆ∞ÂΩï
            editor._selectedImg = null;
        });
    },

    // ÊãñÊãΩ‰∫ã‰ª∂
    _dragHandle: function _dragHandle() {
        var editor = this.editor;

        // Á¶ÅÁî® document ÊãñÊãΩ‰∫ã‰ª∂
        var $document = $(document);
        $document.on('dragleave drop dragenter dragover', function (e) {
            e.preventDefault();
        });

        // Ê∑ªÂä†ÁºñËæëÂå∫ÂüüÊãñÊãΩ‰∫ã‰ª∂
        var $textElem = editor.$textElem;
        $textElem.on('drop', function (e) {
            e.preventDefault();
            var files = e.dataTransfer && e.dataTransfer.files;
            if (!files || !files.length) {
                return;
            }

            // ‰∏ä‰º†ÂõæÁâá
            var uploadImg = editor.uploadImg;
            uploadImg.uploadImg(files);
        });
    }
};

/*
    ÂëΩ‰ª§ÔºåÂ∞ÅË£Ö document.execCommand
*/

// ÊûÑÈÄ†ÂáΩÊï∞
function Command(editor) {
    this.editor = editor;
}

// ‰øÆÊîπÂéüÂûã
Command.prototype = {
    constructor: Command,

    // ÊâßË°åÂëΩ‰ª§
    do: function _do(name, value) {
        var editor = this.editor;

        // ‰ΩøÁî® styleWithCSS
        if (!editor._useStyleWithCSS) {
            document.execCommand('styleWithCSS', null, true);
            editor._useStyleWithCSS = true;
        }

        // Â¶ÇÊûúÊó†ÈÄâÂå∫ÔºåÂøΩÁï•
        if (!editor.selection.getRange()) {
            return;
        }

        // ÊÅ¢Â§çÈÄâÂèñ
        editor.selection.restoreSelection();

        // ÊâßË°å
        var _name = '_' + name;
        if (this[_name]) {
            // ÊúâËá™ÂÆö‰πâ‰∫ã‰ª∂
            this[_name](value);
        } else {
            // ÈªòËÆ§ command
            this._execCommand(name, value);
        }

        // ‰øÆÊîπËèúÂçïÁä∂ÊÄÅ
        editor.menus.changeActive();

        // ÊúÄÂêéÔºåÊÅ¢Â§çÈÄâÂèñ‰øùËØÅÂÖâÊ†áÂú®ÂéüÊù•ÁöÑ‰ΩçÁΩÆÈó™ÁÉÅ
        editor.selection.saveRange();
        editor.selection.restoreSelection();

        // Ëß¶Âèë onchange
        editor.change && editor.change();
    },

    // Ëá™ÂÆö‰πâ insertHTML ‰∫ã‰ª∂
    _insertHTML: function _insertHTML(html) {
        var editor = this.editor;
        var range = editor.selection.getRange();

        if (this.queryCommandSupported('insertHTML')) {
            // W3C
            this._execCommand('insertHTML', html);
        } else if (range.insertNode) {
            // IE
            range.deleteContents();
            range.insertNode($(html)[0]);
        } else if (range.pasteHTML) {
            // IE <= 10
            range.pasteHTML(html);
        }
    },

    // ÊèíÂÖ• elem
    _insertElem: function _insertElem($elem) {
        var editor = this.editor;
        var range = editor.selection.getRange();

        if (range.insertNode) {
            range.deleteContents();
            range.insertNode($elem[0]);
        }
    },

    // Â∞ÅË£Ö execCommand
    _execCommand: function _execCommand(name, value) {
        document.execCommand(name, false, value);
    },

    // Â∞ÅË£Ö document.queryCommandValue
    queryCommandValue: function queryCommandValue(name) {
        return document.queryCommandValue(name);
    },

    // Â∞ÅË£Ö document.queryCommandState
    queryCommandState: function queryCommandState(name) {
        return document.queryCommandState(name);
    },

    // Â∞ÅË£Ö document.queryCommandSupported
    queryCommandSupported: function queryCommandSupported(name) {
        return document.queryCommandSupported(name);
    }
};

/*
    selection range API
*/

// ÊûÑÈÄ†ÂáΩÊï∞
function API(editor) {
    this.editor = editor;
    this._currentRange = null;
}

// ‰øÆÊîπÂéüÂûã
API.prototype = {
    constructor: API,

    // Ëé∑Âèñ range ÂØπË±°
    getRange: function getRange() {
        return this._currentRange;
    },

    // ‰øùÂ≠òÈÄâÂå∫
    saveRange: function saveRange(_range) {
        if (_range) {
            // ‰øùÂ≠òÂ∑≤ÊúâÈÄâÂå∫
            this._currentRange = _range;
            return;
        }

        // Ëé∑ÂèñÂΩìÂâçÁöÑÈÄâÂå∫
        var selection = window.getSelection();
        if (selection.rangeCount === 0) {
            return;
        }
        var range = selection.getRangeAt(0);

        // Âà§Êñ≠ÈÄâÂå∫ÂÜÖÂÆπÊòØÂê¶Âú®ÁºñËæëÂÜÖÂÆπ‰πãÂÜÖ
        var $containerElem = this.getSelectionContainerElem(range);
        if (!$containerElem) {
            return;
        }

        // Âà§Êñ≠ÈÄâÂå∫ÂÜÖÂÆπÊòØÂê¶Âú®‰∏çÂèØÁºñËæëÂå∫Âüü‰πãÂÜÖ
        if ($containerElem.attr('contenteditable') === 'false' || $containerElem.parentUntil('[contenteditable=false]')) {
            return;
        }

        var editor = this.editor;
        var $textElem = editor.$textElem;
        if ($textElem.isContain($containerElem)) {
            // ÊòØÁºñËæëÂÜÖÂÆπ‰πãÂÜÖÁöÑ
            this._currentRange = range;
        }
    },

    // ÊäòÂè†ÈÄâÂå∫
    collapseRange: function collapseRange(toStart) {
        if (toStart == null) {
            // ÈªòËÆ§‰∏∫ false
            toStart = false;
        }
        var range = this._currentRange;
        if (range) {
            range.collapse(toStart);
        }
    },

    // ÈÄâ‰∏≠Âå∫ÂüüÁöÑÊñáÂ≠ó
    getSelectionText: function getSelectionText() {
        var range = this._currentRange;
        if (range) {
            return this._currentRange.toString();
        } else {
            return '';
        }
    },

    // ÈÄâÂå∫ÁöÑ $Elem
    getSelectionContainerElem: function getSelectionContainerElem(range) {
        range = range || this._currentRange;
        var elem = void 0;
        if (range) {
            elem = range.commonAncestorContainer;
            return $(elem.nodeType === 1 ? elem : elem.parentNode);
        }
    },
    getSelectionStartElem: function getSelectionStartElem(range) {
        range = range || this._currentRange;
        var elem = void 0;
        if (range) {
            elem = range.startContainer;
            return $(elem.nodeType === 1 ? elem : elem.parentNode);
        }
    },
    getSelectionEndElem: function getSelectionEndElem(range) {
        range = range || this._currentRange;
        var elem = void 0;
        if (range) {
            elem = range.endContainer;
            return $(elem.nodeType === 1 ? elem : elem.parentNode);
        }
    },

    // ÈÄâÂå∫ÊòØÂê¶‰∏∫Á©∫
    isSelectionEmpty: function isSelectionEmpty() {
        var range = this._currentRange;
        if (range && range.startContainer) {
            if (range.startContainer === range.endContainer) {
                if (range.startOffset === range.endOffset) {
                    return true;
                }
            }
        }
        return false;
    },

    // ÊÅ¢Â§çÈÄâÂå∫
    restoreSelection: function restoreSelection() {
        var selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(this._currentRange);
    },

    // ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁôΩÔºàÂç≥ &#8203 Â≠óÁ¨¶ÔºâÈÄâÂå∫
    createEmptyRange: function createEmptyRange() {
        var editor = this.editor;
        var range = this.getRange();
        var $elem = void 0;

        if (!range) {
            // ÂΩìÂâçÊó† range
            return;
        }
        if (!this.isSelectionEmpty()) {
            // ÂΩìÂâçÈÄâÂå∫ÂøÖÈ°ªÊ≤°ÊúâÂÜÖÂÆπÊâçÂèØ‰ª•
            return;
        }

        try {
            // ÁõÆÂâçÂè™ÊîØÊåÅ webkit ÂÜÖÊ†∏
            if (UA.isWebkit()) {
                // ÊèíÂÖ• &#8203
                editor.cmd.do('insertHTML', '&#8203;');
                // ‰øÆÊîπ offset ‰ΩçÁΩÆ
                range.setEnd(range.endContainer, range.endOffset + 1);
                // Â≠òÂÇ®
                this.saveRange(range);
            } else {
                $elem = $('<strong>&#8203;</strong>');
                editor.cmd.do('insertElem', $elem);
                this.createRangeByElem($elem, true);
            }
        } catch (ex) {
            // ÈÉ®ÂàÜÊÉÖÂÜµ‰∏ã‰ºöÊä•ÈîôÔºåÂÖºÂÆπ‰∏Ä‰∏ã
        }
    },

    // Ê†πÊçÆ $Elem ËÆæÁΩÆÈÄâÂå∫
    createRangeByElem: function createRangeByElem($elem, toStart, isContent) {
        // $elem - ÁªèËøáÂ∞ÅË£ÖÁöÑ elem
        // toStart - true ÂºÄÂßã‰ΩçÁΩÆÔºåfalse ÁªìÊùü‰ΩçÁΩÆ
        // isContent - ÊòØÂê¶ÈÄâ‰∏≠ElemÁöÑÂÜÖÂÆπ
        if (!$elem.length) {
            return;
        }

        var elem = $elem[0];
        var range = document.createRange();

        if (isContent) {
            range.selectNodeContents(elem);
        } else {
            range.selectNode(elem);
        }

        if (typeof toStart === 'boolean') {
            range.collapse(toStart);
        }

        // Â≠òÂÇ® range
        this.saveRange(range);
    }
};

/*
    ‰∏ä‰º†ËøõÂ∫¶Êù°
*/

function Progress(editor) {
    this.editor = editor;
    this._time = 0;
    this._isShow = false;
    this._isRender = false;
    this._timeoutId = 0;
    this.$textContainer = editor.$textContainerElem;
    this.$bar = $('<div class="w-e-progress"></div>');
}

Progress.prototype = {
    constructor: Progress,

    show: function show(progress) {
        var _this = this;

        // Áä∂ÊÄÅÂ§ÑÁêÜ
        if (this._isShow) {
            return;
        }
        this._isShow = true;

        // Ê∏≤Êüì
        var $bar = this.$bar;
        if (!this._isRender) {
            var $textContainer = this.$textContainer;
            $textContainer.append($bar);
        } else {
            this._isRender = true;
        }

        // ÊîπÂèòËøõÂ∫¶ÔºàËäÇÊµÅÔºå100ms Ê∏≤Êüì‰∏ÄÊ¨°Ôºâ
        if (Date.now() - this._time > 100) {
            if (progress <= 1) {
                $bar.css('width', progress * 100 + '%');
                this._time = Date.now();
            }
        }

        // ÈöêËóè
        var timeoutId = this._timeoutId;
        if (timeoutId) {
            clearTimeout(timeoutId);
        }
        timeoutId = setTimeout(function () {
            _this._hide();
        }, 500);
    },

    _hide: function _hide() {
        var $bar = this.$bar;
        $bar.remove();

        // ‰øÆÊîπÁä∂ÊÄÅ
        this._time = 0;
        this._isShow = false;
        this._isRender = false;
    }
};

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};

/*
    ‰∏ä‰º†ÂõæÁâá
*/

// ÊûÑÈÄ†ÂáΩÊï∞
function UploadImg(editor) {
    this.editor = editor;
}

// ÂéüÂûã
UploadImg.prototype = {
    constructor: UploadImg,

    // Ê†πÊçÆ debug ÂºπÂá∫‰∏çÂêåÁöÑ‰ø°ÊÅØ
    _alert: function _alert(alertInfo, debugInfo) {
        var editor = this.editor;
        var debug = editor.config.debug;
        var customAlert = editor.config.customAlert;

        if (debug) {
            throw new Error('wangEditor: ' + (debugInfo || alertInfo));
        } else {
            if (customAlert && typeof customAlert === 'function') {
                customAlert(alertInfo);
            } else {
                alert(alertInfo);
            }
        }
    },

    // Ê†πÊçÆÈìæÊé•ÊèíÂÖ•ÂõæÁâá
    insertLinkImg: function insertLinkImg(link) {
        var _this2 = this;

        if (!link) {
            return;
        }
        var editor = this.editor;
        var config = editor.config;

        // Ê†°È™åÊ†ºÂºè
        var linkImgCheck = config.linkImgCheck;
        var checkResult = void 0;
        if (linkImgCheck && typeof linkImgCheck === 'function') {
            checkResult = linkImgCheck(link);
            if (typeof checkResult === 'string') {
                // Ê†°È™åÂ§±Ë¥•ÔºåÊèêÁ§∫‰ø°ÊÅØ
                alert(checkResult);
                return;
            }
        }

        editor.cmd.do('insertHTML', '<img src="' + link + '" style="max-width:100%;"/>');

        // È™åËØÅÂõæÁâá url ÊòØÂê¶ÊúâÊïàÔºåÊó†ÊïàÁöÑËØùÁªôÂá∫ÊèêÁ§∫
        var img = document.createElement('img');
        img.onload = function () {
            var callback = config.linkImgCallback;
            if (callback && typeof callback === 'function') {
                callback(link);
            }

            img = null;
        };
        img.onerror = function () {
            img = null;
            // Êó†Ê≥ïÊàêÂäü‰∏ãËΩΩÂõæÁâá
            _this2._alert('ÊèíÂÖ•ÂõæÁâáÈîôËØØ', 'wangEditor: \u63D2\u5165\u56FE\u7247\u51FA\u9519\uFF0C\u56FE\u7247\u94FE\u63A5\u662F "' + link + '"\uFF0C\u4E0B\u8F7D\u8BE5\u94FE\u63A5\u5931\u8D25');
            return;
        };
        img.onabort = function () {
            img = null;
        };
        img.src = link;
    },

    // ‰∏ä‰º†ÂõæÁâá
    uploadImg: function uploadImg(files) {
        var _this3 = this;

        if (!files || !files.length) {
            return;
        }

        // ------------------------------ Ëé∑ÂèñÈÖçÁΩÆ‰ø°ÊÅØ ------------------------------
        var editor = this.editor;
        var config = editor.config;
        var uploadImgServer = config.uploadImgServer;
        var uploadImgShowBase64 = config.uploadImgShowBase64;

        var maxSize = config.uploadImgMaxSize;
        var maxSizeM = maxSize / 1024 / 1024;
        var maxLength = config.uploadImgMaxLength || 10000;
        var uploadFileName = config.uploadFileName || '';
        var uploadImgParams = config.uploadImgParams || {};
        var uploadImgParamsWithUrl = config.uploadImgParamsWithUrl;
        var uploadImgHeaders = config.uploadImgHeaders || {};
        var hooks = config.uploadImgHooks || {};
        var timeout = config.uploadImgTimeout || 3000;
        var withCredentials = config.withCredentials;
        if (withCredentials == null) {
            withCredentials = false;
        }
        var customUploadImg = config.customUploadImg;

        if (!customUploadImg) {
            // Ê≤°Êúâ customUploadImg ÁöÑÊÉÖÂÜµ‰∏ãÔºåÈúÄË¶ÅÂ¶Ç‰∏ã‰∏§‰∏™ÈÖçÁΩÆÊâçËÉΩÁªßÁª≠ËøõË°åÂõæÁâá‰∏ä‰º†
            if (!uploadImgServer && !uploadImgShowBase64) {
                return;
            }
        }

        // ------------------------------ È™åËØÅÊñá‰ª∂‰ø°ÊÅØ ------------------------------
        var resultFiles = [];
        var errInfo = [];
        arrForEach(files, function (file) {
            var name = file.name;
            var size = file.size;

            // chrome ‰ΩéÁâàÊú¨ name === undefined
            if (!name || !size) {
                return;
            }

            if (/\.(jpg|jpeg|png|bmp|gif|webp)$/i.test(name) === false) {
                // ÂêéÁºÄÂêç‰∏çÂêàÊ≥ïÔºå‰∏çÊòØÂõæÁâá
                errInfo.push('\u3010' + name + '\u3011\u4E0D\u662F\u56FE\u7247');
                return;
            }
            if (maxSize < size) {
                // ‰∏ä‰º†ÂõæÁâáËøáÂ§ß
                errInfo.push('\u3010' + name + '\u3011\u5927\u4E8E ' + maxSizeM + 'M');
                return;
            }

            // È™åËØÅÈÄöËøáÁöÑÂä†ÂÖ•ÁªìÊûúÂàóË°®
            resultFiles.push(file);
        });
        // ÊäõÂá∫È™åËØÅ‰ø°ÊÅØ
        if (errInfo.length) {
            this._alert('ÂõæÁâáÈ™åËØÅÊú™ÈÄöËøá: \n' + errInfo.join('\n'));
            return;
        }
        if (resultFiles.length > maxLength) {
            this._alert('‰∏ÄÊ¨°ÊúÄÂ§ö‰∏ä‰º†' + maxLength + 'Âº†ÂõæÁâá');
            return;
        }

        // ------------------------------ Ëá™ÂÆö‰πâ‰∏ä‰º† ------------------------------
        if (customUploadImg && typeof customUploadImg === 'function') {
            customUploadImg(resultFiles, this.insertLinkImg.bind(this));

            // ÈòªÊ≠¢‰ª•‰∏ã‰ª£Á†ÅÊâßË°å
            return;
        }

        // Ê∑ªÂä†ÂõæÁâáÊï∞ÊçÆ
        var formdata = new FormData();
        arrForEach(resultFiles, function (file) {
            var name = uploadFileName || file.name;
            formdata.append(name, file);
        });

        // ------------------------------ ‰∏ä‰º†ÂõæÁâá ------------------------------
        if (uploadImgServer && typeof uploadImgServer === 'string') {
            // Ê∑ªÂä†ÂèÇÊï∞
            var uploadImgServerArr = uploadImgServer.split('#');
            uploadImgServer = uploadImgServerArr[0];
            var uploadImgServerHash = uploadImgServerArr[1] || '';
            objForEach(uploadImgParams, function (key, val) {
                // Âõ†‰ΩøÁî®ËÄÖÂèçÂ∫îÔºåËá™ÂÆö‰πâÂèÇÊï∞‰∏çËÉΩÈªòËÆ§ encode ÔºåÁî± v3.1.1 ÁâàÊú¨ÂºÄÂßãÊ≥®ÈáäÊéâ
                // val = encodeURIComponent(val)

                // Á¨¨‰∏ÄÔºåÂ∞ÜÂèÇÊï∞ÊãºÊé•Âà∞ url ‰∏≠
                if (uploadImgParamsWithUrl) {
                    if (uploadImgServer.indexOf('?') > 0) {
                        uploadImgServer += '&';
                    } else {
                        uploadImgServer += '?';
                    }
                    uploadImgServer = uploadImgServer + key + '=' + val;
                }

                // Á¨¨‰∫åÔºåÂ∞ÜÂèÇÊï∞Ê∑ªÂä†Âà∞ formdata ‰∏≠
                formdata.append(key, val);
            });
            if (uploadImgServerHash) {
                uploadImgServer += '#' + uploadImgServerHash;
            }

            // ÂÆö‰πâ xhr
            var xhr = new XMLHttpRequest();
            xhr.open('POST', uploadImgServer);

            // ËÆæÁΩÆË∂ÖÊó∂
            xhr.timeout = timeout;
            xhr.ontimeout = function () {
                // hook - timeout
                if (hooks.timeout && typeof hooks.timeout === 'function') {
                    hooks.timeout(xhr, editor);
                }

                _this3._alert('‰∏ä‰º†ÂõæÁâáË∂ÖÊó∂');
            };

            // ÁõëÊéß progress
            if (xhr.upload) {
                xhr.upload.onprogress = function (e) {
                    var percent = void 0;
                    // ËøõÂ∫¶Êù°
                    var progressBar = new Progress(editor);
                    if (e.lengthComputable) {
                        percent = e.loaded / e.total;
                        progressBar.show(percent);
                    }
                };
            }

            // ËøîÂõûÊï∞ÊçÆ
            xhr.onreadystatechange = function () {
                var result = void 0;
                if (xhr.readyState === 4) {
                    if (xhr.status < 200 || xhr.status >= 300) {
                        // hook - error
                        if (hooks.error && typeof hooks.error === 'function') {
                            hooks.error(xhr, editor);
                        }

                        // xhr ËøîÂõûÁä∂ÊÄÅÈîôËØØ
                        _this3._alert('‰∏ä‰º†ÂõæÁâáÂèëÁîüÈîôËØØ', '\u4E0A\u4F20\u56FE\u7247\u53D1\u751F\u9519\u8BEF\uFF0C\u670D\u52A1\u5668\u8FD4\u56DE\u72B6\u6001\u662F ' + xhr.status);
                        return;
                    }

                    result = xhr.responseText;
                    if ((typeof result === 'undefined' ? 'undefined' : _typeof(result)) !== 'object') {
                        try {
                            result = JSON.parse(result);
                        } catch (ex) {
                            // hook - fail
                            if (hooks.fail && typeof hooks.fail === 'function') {
                                hooks.fail(xhr, editor, result);
                            }

                            _this3._alert('‰∏ä‰º†ÂõæÁâáÂ§±Ë¥•', '‰∏ä‰º†ÂõæÁâáËøîÂõûÁªìÊûúÈîôËØØÔºåËøîÂõûÁªìÊûúÊòØ: ' + result);
                            return;
                        }
                    }
                    if (!hooks.customInsert && result.errno != '0') {
                        // hook - fail
                        if (hooks.fail && typeof hooks.fail === 'function') {
                            hooks.fail(xhr, editor, result);
                        }

                        // Êï∞ÊçÆÈîôËØØ
                        _this3._alert('‰∏ä‰º†ÂõæÁâáÂ§±Ë¥•', '‰∏ä‰º†ÂõæÁâáËøîÂõûÁªìÊûúÈîôËØØÔºåËøîÂõûÁªìÊûú errno=' + result.errno);
                    } else {
                        if (hooks.customInsert && typeof hooks.customInsert === 'function') {
                            // ‰ΩøÁî®ËÄÖËá™ÂÆö‰πâÊèíÂÖ•ÊñπÊ≥ï
                            hooks.customInsert(_this3.insertLinkImg.bind(_this3), result, editor);
                        } else {
                            // Â∞ÜÂõæÁâáÊèíÂÖ•ÁºñËæëÂô®
                            var data = result.data || [];
                            data.forEach(function (link) {
                                _this3.insertLinkImg(link);
                            });
                        }

                        // hook - success
                        if (hooks.success && typeof hooks.success === 'function') {
                            hooks.success(xhr, editor, result);
                        }
                    }
                }
            };

            // hook - before
            if (hooks.before && typeof hooks.before === 'function') {
                var beforeResult = hooks.before(xhr, editor, resultFiles);
                if (beforeResult && (typeof beforeResult === 'undefined' ? 'undefined' : _typeof(beforeResult)) === 'object') {
                    if (beforeResult.prevent) {
                        // Â¶ÇÊûúËøîÂõûÁöÑÁªìÊûúÊòØ {prevent: true, msg: 'xxxx'} ÂàôË°®Á§∫Áî®Êà∑ÊîæÂºÉ‰∏ä‰º†
                        this._alert(beforeResult.msg);
                        return;
                    }
                }
            }

            // Ëá™ÂÆö‰πâ headers
            objForEach(uploadImgHeaders, function (key, val) {
                xhr.setRequestHeader(key, val);
            });

            // Ë∑®Âüü‰º† cookie
            xhr.withCredentials = withCredentials;

            // ÂèëÈÄÅËØ∑Ê±Ç
            xhr.send(formdata);

            // Ê≥®ÊÑèÔºåË¶Å return „ÄÇ‰∏çÂéªÊìç‰ΩúÊé•‰∏ãÊù•ÁöÑ base64 ÊòæÁ§∫ÊñπÂºè
            return;
        }

        // ------------------------------ ÊòæÁ§∫ base64 Ê†ºÂºè ------------------------------
        if (uploadImgShowBase64) {
            arrForEach(files, function (file) {
                var _this = _this3;
                var reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = function () {
                    _this.insertLinkImg(this.result);
                };
            });
        }
    }
};

/*
    ÁºñËæëÂô®ÊûÑÈÄ†ÂáΩÊï∞
*/

// idÔºåÁ¥ØÂä†
var editorId = 1;

// ÊûÑÈÄ†ÂáΩÊï∞
function Editor(toolbarSelector, textSelector) {
    if (toolbarSelector == null) {
        // Ê≤°Êúâ‰º†ÂÖ•‰ªª‰ΩïÂèÇÊï∞ÔºåÊä•Èîô
        throw new Error('ÈîôËØØÔºöÂàùÂßãÂåñÁºñËæëÂô®Êó∂ÂÄôÊú™‰º†ÂÖ•‰ªª‰ΩïÂèÇÊï∞ÔºåËØ∑Êü•ÈòÖÊñáÊ°£');
    }
    // idÔºåÁî®‰ª•Âå∫ÂàÜÂçï‰∏™È°µÈù¢‰∏çÂêåÁöÑÁºñËæëÂô®ÂØπË±°
    this.id = 'wangEditor-' + editorId++;

    this.toolbarSelector = toolbarSelector;
    this.textSelector = textSelector;

    // Ëá™ÂÆö‰πâÈÖçÁΩÆ
    this.customConfig = {};
}

// ‰øÆÊîπÂéüÂûã
Editor.prototype = {
    constructor: Editor,

    // ÂàùÂßãÂåñÈÖçÁΩÆ
    _initConfig: function _initConfig() {
        // _config ÊòØÈªòËÆ§ÈÖçÁΩÆÔºåthis.customConfig ÊòØÁî®Êà∑Ëá™ÂÆö‰πâÈÖçÁΩÆÔºåÂ∞ÜÂÆÉ‰ª¨ merge ‰πãÂêéÂÜçËµãÂÄº
        var target = {};
        this.config = Object.assign(target, config, this.customConfig);

        // Â∞ÜËØ≠Ë®ÄÈÖçÁΩÆÔºåÁîüÊàêÊ≠£ÂàôË°®ËææÂºè
        var langConfig = this.config.lang || {};
        var langArgs = [];
        objForEach(langConfig, function (key, val) {
            // key Âç≥ÈúÄË¶ÅÁîüÊàêÊ≠£ÂàôË°®ËææÂºèÁöÑËßÑÂàôÔºåÂ¶Ç‚ÄúÊèíÂÖ•ÈìæÊé•‚Äù
            // val Âç≥ÈúÄË¶ÅË¢´ÊõøÊç¢ÊàêÁöÑËØ≠Ë®ÄÔºåÂ¶Ç‚Äúinsert link‚Äù
            langArgs.push({
                reg: new RegExp(key, 'img'),
                val: val

            });
        });
        this.config.langArgs = langArgs;
    },

    // ÂàùÂßãÂåñ DOM
    _initDom: function _initDom() {
        var _this = this;

        var toolbarSelector = this.toolbarSelector;
        var $toolbarSelector = $(toolbarSelector);
        var textSelector = this.textSelector;

        var config$$1 = this.config;
        var zIndex = config$$1.zIndex;

        // ÂÆö‰πâÂèòÈáè
        var $toolbarElem = void 0,
            $textContainerElem = void 0,
            $textElem = void 0,
            $children = void 0;

        if (textSelector == null) {
            // Âè™‰º†ÂÖ•‰∏Ä‰∏™ÂèÇÊï∞ÔºåÂç≥ÊòØÂÆπÂô®ÁöÑÈÄâÊã©Âô®ÊàñÂÖÉÁ¥†Ôºåtoolbar Âíå text ÁöÑÂÖÉÁ¥†Ëá™Ë°åÂàõÂª∫
            $toolbarElem = $('<div></div>');
            $textContainerElem = $('<div></div>');

            // Â∞ÜÁºñËæëÂô®Âå∫ÂüüÂéüÊúâÁöÑÂÜÖÂÆπÔºåÊöÇÂ≠òËµ∑Êù•
            $children = $toolbarSelector.children();

            // Ê∑ªÂä†Âà∞ DOM ÁªìÊûÑ‰∏≠
            $toolbarSelector.append($toolbarElem).append($textContainerElem);

            // Ëá™Ë°åÂàõÂª∫ÁöÑÔºåÈúÄË¶ÅÈÖçÁΩÆÈªòËÆ§ÁöÑÊ†∑Âºè
            $toolbarElem.css('background-color', '#f1f1f1').css('border', '1px solid #ccc');
            $textContainerElem.css('border', '1px solid #ccc').css('border-top', 'none').css('height', '300px');
        } else {
            // toolbar Âíå text ÁöÑÈÄâÊã©Âô®ÈÉΩÊúâÂÄºÔºåËÆ∞ÂΩïÂ±ûÊÄß
            $toolbarElem = $toolbarSelector;
            $textContainerElem = $(textSelector);
            // Â∞ÜÁºñËæëÂô®Âå∫ÂüüÂéüÊúâÁöÑÂÜÖÂÆπÔºåÊöÇÂ≠òËµ∑Êù•
            $children = $textContainerElem.children();
        }

        // ÁºñËæëÂå∫Âüü
        $textElem = $('<div></div>');
        $textElem.attr('contenteditable', 'true').css('width', '100%').css('height', '100%');

        // ÂàùÂßãÂåñÁºñËæëÂå∫ÂüüÂÜÖÂÆπ
        if ($children && $children.length) {
            $textElem.append($children);
        } else {
            $textElem.append($('<p><br></p>'));
        }

        // ÁºñËæëÂå∫ÂüüÂä†ÂÖ•DOM
        $textContainerElem.append($textElem);

        // ËÆæÁΩÆÈÄöÁî®ÁöÑ class
        $toolbarElem.addClass('w-e-toolbar');
        $textContainerElem.addClass('w-e-text-container');
        $textContainerElem.css('z-index', zIndex);
        $textElem.addClass('w-e-text');

        // Ê∑ªÂä† ID
        var toolbarElemId = getRandom('toolbar-elem');
        $toolbarElem.attr('id', toolbarElemId);
        var textElemId = getRandom('text-elem');
        $textElem.attr('id', textElemId);

        // ËÆ∞ÂΩïÂ±ûÊÄß
        this.$toolbarElem = $toolbarElem;
        this.$textContainerElem = $textContainerElem;
        this.$textElem = $textElem;
        this.toolbarElemId = toolbarElemId;
        this.textElemId = textElemId;

        // ËÆ∞ÂΩïËæìÂÖ•Ê≥ïÁöÑÂºÄÂßãÂíåÁªìÊùü
        var compositionEnd = true;
        $textContainerElem.on('compositionstart', function () {
            // ËæìÂÖ•Ê≥ïÂºÄÂßãËæìÂÖ•
            compositionEnd = false;
        });
        $textContainerElem.on('compositionend', function () {
            // ËæìÂÖ•Ê≥ïÁªìÊùüËæìÂÖ•
            compositionEnd = true;
        });

        // ÁªëÂÆö onchange
        $textContainerElem.on('click keyup', function () {
            // ËæìÂÖ•Ê≥ïÁªìÊùüÊâçÂá∫Âèë onchange
            compositionEnd && _this.change && _this.change();
        });
        $toolbarElem.on('click', function () {
            this.change && this.change();
        });

        //ÁªëÂÆö onfocus ‰∏é onblur ‰∫ã‰ª∂
        if (config$$1.onfocus || config$$1.onblur) {
            // ÂΩìÂâçÁºñËæëÂô®ÊòØÂê¶ÊòØÁÑ¶ÁÇπÁä∂ÊÄÅ
            this.isFocus = false;

            $(document).on('click', function (e) {
                //Âà§Êñ≠ÂΩìÂâçÁÇπÂáªÂÖÉÁ¥†ÊòØÂê¶Âú®ÁºñËæëÂô®ÂÜÖ
                var isChild = $textElem.isContain($(e.target));

                //Âà§Êñ≠ÂΩìÂâçÁÇπÂáªÂÖÉÁ¥†ÊòØÂê¶‰∏∫Â∑•ÂÖ∑Ê†è
                var isToolbar = $toolbarElem.isContain($(e.target));
                var isMenu = $toolbarElem[0] == e.target ? true : false;

                if (!isChild) {
                    //Ëã•‰∏∫ÈÄâÊã©Â∑•ÂÖ∑Ê†è‰∏≠ÁöÑÂäüËÉΩÔºåÂàô‰∏çËßÜ‰∏∫ÊàêblurÊìç‰Ωú
                    if (isToolbar && !isMenu) {
                        return;
                    }

                    if (_this.isFocus) {
                        _this.onblur && _this.onblur();
                    }
                    _this.isFocus = false;
                } else {
                    if (!_this.isFocus) {
                        _this.onfocus && _this.onfocus();
                    }
                    _this.isFocus = true;
                }
            });
        }
    },

    // Â∞ÅË£Ö command
    _initCommand: function _initCommand() {
        this.cmd = new Command(this);
    },

    // Â∞ÅË£Ö selection range API
    _initSelectionAPI: function _initSelectionAPI() {
        this.selection = new API(this);
    },

    // Ê∑ªÂä†ÂõæÁâá‰∏ä‰º†
    _initUploadImg: function _initUploadImg() {
        this.uploadImg = new UploadImg(this);
    },

    // ÂàùÂßãÂåñËèúÂçï
    _initMenus: function _initMenus() {
        this.menus = new Menus(this);
        this.menus.init();
    },

    // Ê∑ªÂä† text Âå∫Âüü
    _initText: function _initText() {
        this.txt = new Text(this);
        this.txt.init();
    },

    // ÂàùÂßãÂåñÈÄâÂå∫ÔºåÂ∞ÜÂÖâÊ†áÂÆö‰ΩçÂà∞ÂÜÖÂÆπÂ∞æÈÉ®
    initSelection: function initSelection(newLine) {
        var $textElem = this.$textElem;
        var $children = $textElem.children();
        if (!$children.length) {
            // Â¶ÇÊûúÁºñËæëÂô®Âå∫ÂüüÊó†ÂÜÖÂÆπÔºåÊ∑ªÂä†‰∏Ä‰∏™Á©∫Ë°åÔºåÈáçÊñ∞ËÆæÁΩÆÈÄâÂå∫
            $textElem.append($('<p><br></p>'));
            this.initSelection();
            return;
        }

        var $last = $children.last();

        if (newLine) {
            // Êñ∞Â¢û‰∏Ä‰∏™Á©∫Ë°å
            var html = $last.html().toLowerCase();
            var nodeName = $last.getNodeName();
            if (html !== '<br>' && html !== '<br\/>' || nodeName !== 'P') {
                // ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†‰∏çÊòØ <p><br></p>ÔºåÊ∑ªÂä†‰∏Ä‰∏™Á©∫Ë°åÔºåÈáçÊñ∞ËÆæÁΩÆÈÄâÂå∫
                $textElem.append($('<p><br></p>'));
                this.initSelection();
                return;
            }
        }

        this.selection.createRangeByElem($last, false, true);
        this.selection.restoreSelection();
    },

    // ÁªëÂÆö‰∫ã‰ª∂
    _bindEvent: function _bindEvent() {
        // -------- ÁªëÂÆö onchange ‰∫ã‰ª∂ --------
        var onChangeTimeoutId = 0;
        var beforeChangeHtml = this.txt.html();
        var config$$1 = this.config;

        // onchange Ëß¶ÂèëÂª∂ËøüÊó∂Èó¥
        var onchangeTimeout = config$$1.onchangeTimeout;
        onchangeTimeout = parseInt(onchangeTimeout, 10);
        if (!onchangeTimeout || onchangeTimeout <= 0) {
            onchangeTimeout = 200;
        }

        var onchange = config$$1.onchange;
        if (onchange && typeof onchange === 'function') {
            // Ëß¶Âèë change ÁöÑÊúâ‰∏â‰∏™Âú∫ÊôØÔºö
            // 1. $textContainerElem.on('click keyup')
            // 2. $toolbarElem.on('click')
            // 3. editor.cmd.do()
            this.change = function () {
                // Âà§Êñ≠ÊòØÂê¶ÊúâÂèòÂåñ
                var currentHtml = this.txt.html();

                if (currentHtml.length === beforeChangeHtml.length) {
                    // ÈúÄË¶ÅÊØîËæÉÊØè‰∏Ä‰∏™Â≠óÁ¨¶
                    if (currentHtml === beforeChangeHtml) {
                        return;
                    }
                }

                // ÊâßË°åÔºå‰ΩøÁî®ËäÇÊµÅ
                if (onChangeTimeoutId) {
                    clearTimeout(onChangeTimeoutId);
                }
                onChangeTimeoutId = setTimeout(function () {
                    // Ëß¶ÂèëÈÖçÁΩÆÁöÑ onchange ÂáΩÊï∞
                    onchange(currentHtml);
                    beforeChangeHtml = currentHtml;
                }, onchangeTimeout);
            };
        }

        // -------- ÁªëÂÆö onblur ‰∫ã‰ª∂ --------
        var onblur = config$$1.onblur;
        if (onblur && typeof onblur === 'function') {
            this.onblur = function () {
                var currentHtml = this.txt.html();
                onblur(currentHtml);
            };
        }

        // -------- ÁªëÂÆö onfocus ‰∫ã‰ª∂ --------
        var onfocus = config$$1.onfocus;
        if (onfocus && typeof onfocus === 'function') {
            this.onfocus = function () {
                onfocus();
            };
        }
    },

    // ÂàõÂª∫ÁºñËæëÂô®
    create: function create() {
        // ÂàùÂßãÂåñÈÖçÁΩÆ‰ø°ÊÅØ
        this._initConfig();

        // ÂàùÂßãÂåñ DOM
        this._initDom();

        // Â∞ÅË£Ö command API
        this._initCommand();

        // Â∞ÅË£Ö selection range API
        this._initSelectionAPI();

        // Ê∑ªÂä† text
        this._initText();

        // ÂàùÂßãÂåñËèúÂçï
        this._initMenus();

        // Ê∑ªÂä† ÂõæÁâá‰∏ä‰º†
        this._initUploadImg();

        // ÂàùÂßãÂåñÈÄâÂå∫ÔºåÂ∞ÜÂÖâÊ†áÂÆö‰ΩçÂà∞ÂÜÖÂÆπÂ∞æÈÉ®
        this.initSelection(true);

        // ÁªëÂÆö‰∫ã‰ª∂
        this._bindEvent();
    },

    // Ëß£ÁªëÊâÄÊúâ‰∫ã‰ª∂ÔºàÊöÇÊó∂‰∏çÂØπÂ§ñÂºÄÊîæÔºâ
    _offAllEvent: function _offAllEvent() {
        $.offAll();
    }
};

// Ê£ÄÈ™åÊòØÂê¶ÊµèËßàÂô®ÁéØÂ¢É
try {
    document;
} catch (ex) {
    throw new Error('ËØ∑Âú®ÊµèËßàÂô®ÁéØÂ¢É‰∏ãËøêË°å');
}

// polyfill
polyfill();

// ËøôÈáåÁöÑ `inlinecss` Â∞ÜË¢´ÊõøÊç¢Êàê css ‰ª£Á†ÅÁöÑÂÜÖÂÆπÔºåËØ¶ÊÉÖÂèØÂéª ./gulpfile.js ‰∏≠ÊêúÁ¥¢ `inlinecss` ÂÖ≥ÈîÆÂ≠ó
var inlinecss = '.w-e-toolbar,.w-e-text-container,.w-e-menu-panel {  padding: 0;  margin: 0;  box-sizing: border-box;}.w-e-toolbar *,.w-e-text-container *,.w-e-menu-panel * {  padding: 0;  margin: 0;  box-sizing: border-box;}.w-e-clear-fix:after {  content: "";  display: table;  clear: both;}.w-e-toolbar .w-e-droplist {  position: absolute;  left: 0;  top: 0;  background-color: #fff;  border: 1px solid #f1f1f1;  border-right-color: #ccc;  border-bottom-color: #ccc;}.w-e-toolbar .w-e-droplist .w-e-dp-title {  text-align: center;  color: #999;  line-height: 2;  border-bottom: 1px solid #f1f1f1;  font-size: 13px;}.w-e-toolbar .w-e-droplist ul.w-e-list {  list-style: none;  line-height: 1;}.w-e-toolbar .w-e-droplist ul.w-e-list li.w-e-item {  color: #333;  padding: 5px 0;}.w-e-toolbar .w-e-droplist ul.w-e-list li.w-e-item:hover {  background-color: #f1f1f1;}.w-e-toolbar .w-e-droplist ul.w-e-block {  list-style: none;  text-align: left;  padding: 5px;}.w-e-toolbar .w-e-droplist ul.w-e-block li.w-e-item {  display: inline-block;  *display: inline;  *zoom: 1;  padding: 3px 5px;}.w-e-toolbar .w-e-droplist ul.w-e-block li.w-e-item:hover {  background-color: #f1f1f1;}@font-face {  font-family: \'w-e-icon\';  src: url(data:application/x-font-woff;charset=utf-8;base64,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) format(\'truetype\');  font-weight: normal;  font-style: normal;}[class^="w-e-icon-"],[class*=" w-e-icon-"] {  /* use !important to prevent issues with browser extensions that change fonts */  font-family: \'w-e-icon\' !important;  speak: none;  font-style: normal;  font-weight: normal;  font-variant: normal;  text-transform: none;  line-height: 1;  /* Better Font Rendering =========== */  -webkit-font-smoothing: antialiased;  -moz-osx-font-smoothing: grayscale;}.w-e-icon-close:before {  content: "\\f00d";}.w-e-icon-upload2:before {  content: "\\e9c6";}.w-e-icon-trash-o:before {  content: "\\f014";}.w-e-icon-header:before {  content: "\\f1dc";}.w-e-icon-pencil2:before {  content: "\\e906";}.w-e-icon-paint-brush:before {  content: "\\f1fc";}.w-e-icon-image:before {  content: "\\e90d";}.w-e-icon-play:before {  content: "\\e912";}.w-e-icon-location:before {  content: "\\e947";}.w-e-icon-undo:before {  content: "\\e965";}.w-e-icon-redo:before {  content: "\\e966";}.w-e-icon-quotes-left:before {  content: "\\e977";}.w-e-icon-list-numbered:before {  content: "\\e9b9";}.w-e-icon-list2:before {  content: "\\e9bb";}.w-e-icon-link:before {  content: "\\e9cb";}.w-e-icon-happy:before {  content: "\\e9df";}.w-e-icon-bold:before {  content: "\\ea62";}.w-e-icon-underline:before {  content: "\\ea63";}.w-e-icon-italic:before {  content: "\\ea64";}.w-e-icon-strikethrough:before {  content: "\\ea65";}.w-e-icon-table2:before {  content: "\\ea71";}.w-e-icon-paragraph-left:before {  content: "\\ea77";}.w-e-icon-paragraph-center:before {  content: "\\ea78";}.w-e-icon-paragraph-right:before {  content: "\\ea79";}.w-e-icon-terminal:before {  content: "\\f120";}.w-e-icon-page-break:before {  content: "\\ea68";}.w-e-icon-cancel-circle:before {  content: "\\ea0d";}.w-e-icon-font:before {  content: "\\ea5c";}.w-e-icon-text-heigh:before {  content: "\\ea5f";}.w-e-toolbar {  display: -webkit-box;  display: -ms-flexbox;  display: flex;  padding: 0 5px;  /* flex-wrap: wrap; */  /* Âçï‰∏™ËèúÂçï */}.w-e-toolbar .w-e-menu {  position: relative;  text-align: center;  padding: 5px 10px;  cursor: pointer;}.w-e-toolbar .w-e-menu i {  color: #999;}.w-e-toolbar .w-e-menu:hover i {  color: #333;}.w-e-toolbar .w-e-active i {  color: #1e88e5;}.w-e-toolbar .w-e-active:hover i {  color: #1e88e5;}.w-e-text-container .w-e-panel-container {  position: absolute;  top: 0;  left: 50%;  border: 1px solid #ccc;  border-top: 0;  box-shadow: 1px 1px 2px #ccc;  color: #333;  background-color: #fff;  /* ‰∏∫ emotion panel ÂÆöÂà∂ÁöÑÊ†∑Âºè */  /* ‰∏ä‰º†ÂõæÁâáÁöÑ panel ÂÆöÂà∂Ê†∑Âºè */}.w-e-text-container .w-e-panel-container .w-e-panel-close {  position: absolute;  right: 0;  top: 0;  padding: 5px;  margin: 2px 5px 0 0;  cursor: pointer;  color: #999;}.w-e-text-container .w-e-panel-container .w-e-panel-close:hover {  color: #333;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-title {  list-style: none;  display: -webkit-box;  display: -ms-flexbox;  display: flex;  font-size: 14px;  margin: 2px 10px 0 10px;  border-bottom: 1px solid #f1f1f1;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-title .w-e-item {  padding: 3px 5px;  color: #999;  cursor: pointer;  margin: 0 3px;  position: relative;  top: 1px;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-title .w-e-active {  color: #333;  border-bottom: 1px solid #333;  cursor: default;  font-weight: 700;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content {  padding: 10px 15px 10px 15px;  font-size: 16px;  /* ËæìÂÖ•Ê°ÜÁöÑÊ†∑Âºè */  /* ÊåâÈíÆÁöÑÊ†∑Âºè */}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input:focus,.w-e-text-container .w-e-panel-container .w-e-panel-tab-content textarea:focus,.w-e-text-container .w-e-panel-container .w-e-panel-tab-content button:focus {  outline: none;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content textarea {  width: 100%;  border: 1px solid #ccc;  padding: 5px;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content textarea:focus {  border-color: #1e88e5;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text] {  border: none;  border-bottom: 1px solid #ccc;  font-size: 14px;  height: 20px;  color: #333;  text-align: left;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text].small {  width: 30px;  text-align: center;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text].block {  display: block;  width: 100%;  margin: 10px 0;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content input[type=text]:focus {  border-bottom: 2px solid #1e88e5;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button {  font-size: 14px;  color: #1e88e5;  border: none;  padding: 5px 10px;  background-color: #fff;  cursor: pointer;  border-radius: 3px;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.left {  float: left;  margin-right: 10px;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.right {  float: right;  margin-left: 10px;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.gray {  color: #999;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.red {  color: #c24f4a;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button:hover {  background-color: #f1f1f1;}.w-e-text-container .w-e-panel-container .w-e-panel-tab-content .w-e-button-container:after {  content: "";  display: table;  clear: both;}.w-e-text-container .w-e-panel-container .w-e-emoticon-container .w-e-item {  cursor: pointer;  font-size: 18px;  padding: 0 3px;  display: inline-block;  *display: inline;  *zoom: 1;}.w-e-text-container .w-e-panel-container .w-e-up-img-container {  text-align: center;}.w-e-text-container .w-e-panel-container .w-e-up-img-container .w-e-up-btn {  display: inline-block;  *display: inline;  *zoom: 1;  color: #999;  cursor: pointer;  font-size: 60px;  line-height: 1;}.w-e-text-container .w-e-panel-container .w-e-up-img-container .w-e-up-btn:hover {  color: #333;}.w-e-text-container {  position: relative;}.w-e-text-container .w-e-progress {  position: absolute;  background-color: #1e88e5;  bottom: 0;  left: 0;  height: 1px;}.w-e-text {  padding: 0 10px;  overflow-y: scroll;}.w-e-text p,.w-e-text h1,.w-e-text h2,.w-e-text h3,.w-e-text h4,.w-e-text h5,.w-e-text table,.w-e-text pre {  margin: 10px 0;  line-height: 1.5;}.w-e-text ul,.w-e-text ol {  margin: 10px 0 10px 20px;}.w-e-text blockquote {  display: block;  border-left: 8px solid #d0e5f2;  padding: 5px 10px;  margin: 10px 0;  line-height: 1.4;  font-size: 100%;  background-color: #f1f1f1;}.w-e-text code {  display: inline-block;  *display: inline;  *zoom: 1;  background-color: #f1f1f1;  border-radius: 3px;  padding: 3px 5px;  margin: 0 3px;}.w-e-text pre code {  display: block;}.w-e-text table {  border-top: 1px solid #ccc;  border-left: 1px solid #ccc;}.w-e-text table td,.w-e-text table th {  border-bottom: 1px solid #ccc;  border-right: 1px solid #ccc;  padding: 3px 5px;}.w-e-text table th {  border-bottom: 2px solid #ccc;  text-align: center;}.w-e-text:focus {  outline: none;}.w-e-text img {  cursor: pointer;}.w-e-text img:hover {  box-shadow: 0 0 5px #333;}';

// Â∞Ü css ‰ª£Á†ÅÊ∑ªÂä†Âà∞ <style> ‰∏≠
var style = document.createElement('style');
style.type = 'text/css';
style.innerHTML = inlinecss;
document.getElementsByTagName('HEAD').item(0).appendChild(style);

// ËøîÂõû
var index = window.wangEditor || Editor;

return index;

})));


/***/ }),

/***/ "./node_modules/wangeditor/release/wangEditor.min.css":
/*!************************************************************!*\
  !*** ./node_modules/wangeditor/release/wangEditor.min.css ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {


var content = __webpack_require__(/*! !../../css-loader??ref--6-1!../../postcss-loader/src??ref--6-2!./wangEditor.min.css */ "./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/wangeditor/release/wangEditor.min.css");

if(typeof content === 'string') content = [[module.i, content, '']];

var transform;
var insertInto;



var options = {"hmr":true}

options.transform = transform
options.insertInto = undefined;

var update = __webpack_require__(/*! ../../style-loader/lib/addStyles.js */ "./node_modules/style-loader/lib/addStyles.js")(content, options);

if(content.locals) module.exports = content.locals;

if(false) {}

/***/ })

}]);